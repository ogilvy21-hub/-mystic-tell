<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üîÆ MysticTell - ÎßûÏ∂§ Ïö¥ÏÑ∏</title>
    <meta name="description" content="Ïã†ÎπÑÎ°úÏö¥ ÎØ∏ÎûòÎ•º ÏïåÎ†§ÎìúÎ¶¨Îäî ÎîîÏßÄÌÑ∏ Ï†êÏà†ÏÇ¨ - Ïò§ÎäòÏùò Ïö¥ÏÑ∏, Ï†ïÌÜµ ÏÇ¨Ï£º, ÌÉÄÎ°ú Ïπ¥Îìú">
    <meta name="keywords" content="Ïö¥ÏÑ∏, ÏÇ¨Ï£º, ÌÉÄÎ°ú, Ï†êÏà†, ÎØ∏Ïä§Ìã±ÌÖî">
    
    <style>
        :root {
            --splash-bg-url: url('https://i.imgur.com/zjaoFlI.png');
            --start-img-url: url('https://i.imgur.com/SmhPkiD.png');
            --start-blink-duration: 1700ms;
            --start-blink-scale-min: 1;
            --start-blink-scale-max: 1.06;
            --start-blink-opacity-min: .85;
            --sheetW: 640px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Apple SD Gothic Neo', 'Malgun Gothic', sans-serif;
            background: #fff;
            min-height: 100vh;
            color: #333;
            overflow-x: hidden;
        }

        .container {
            max-width: 430px;
            margin: 0 auto;
            min-height: 100vh;
            position: relative;
        }

        /* ===== Ïä§ÌîåÎûòÏãú ÌôîÎ©¥ ===== */
        #splashScreen {
            position: fixed;
            inset: 0;
            z-index: 99999;
            display: flex;
            align-items: center;
            justify-content: center;
            background: center/cover no-repeat var(--splash-bg-url);
            touch-action: manipulation;
        }

        #splashScreen::after {
            content: "";
            position: absolute;
            inset: 0;
            background: linear-gradient(to bottom, rgba(0,0,0,.10), rgba(0,0,0,.18));
            pointer-events: none;
        }

        #splashScreen.hidden {
            opacity: 0;
            transform: scale(.98);
            pointer-events: none;
            transition: all .6s ease;
            display: none !important;
        }

        .start-image-btn {
            position: relative;
            z-index: 2;
            display: block;
            width: min(100%, 400px);
            aspect-ratio: 3.2 / 1;
            background: center/contain no-repeat var(--start-img-url);
            border: none;
            outline: none;
            cursor: pointer;
            -webkit-tap-highlight-color: transparent;
            filter: drop-shadow(0 10px 22px rgba(0,0,0,.35));
            transition: transform .08s ease, filter .12s ease;
            animation: start-blink var(--start-blink-duration) ease-in-out infinite;
            will-change: transform, opacity, filter;
        }

        .start-image-btn:active {
            transform: translateY(1px) scale(.99);
            filter: drop-shadow(0 6px 16px rgba(0,0,0,.35));
        }

        @keyframes start-blink {
            0%, 100% {
                opacity: var(--start-blink-opacity-min);
                transform: scale(var(--start-blink-scale-min));
                filter: drop-shadow(0 10px 22px rgba(0,0,0,.32));
            }
            50% {
                opacity: 1;
                transform: scale(var(--start-blink-scale-max));
                filter: drop-shadow(0 16px 28px rgba(0,0,0,.4));
            }
        }

        /* ===== Î©îÏù∏ ÏΩòÌÖêÏ∏† ===== */
        #mainContent {
            display: none;
            background: #fff;
            min-height: 100vh;
            padding: 20px;
            padding-bottom: 100px;
        }

        #mainContent.show {
            display: block;
            animation: slideIn .8s ease-out;
        }

        @keyframes slideIn {
            from { transform: translateY(100%); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            text-align: center;
            color: #fff;
            border-radius: 0 0 30px 30px;
            margin: -20px -20px 30px -20px;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,.1) 0%, transparent 70%);
            animation: sparkle 4s ease-in-out infinite;
        }

        @keyframes sparkle {
            0%, 100% { opacity: .3; transform: scale(1); }
            50% { opacity: .8; transform: scale(1.1); }
        }

        .logo {
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 8px;
            position: relative;
            z-index: 2;
        }

        .subtitle {
            font-size: 14px;
            opacity: .9;
            position: relative;
            z-index: 2;
        }

        #mainCrystal {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            margin: 20px auto;
            border: 3px solid rgba(102,126,234,.3);
            background: radial-gradient(circle at 30% 30%, rgba(255,255,255,.8), rgba(255,255,255,.3), transparent);
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            color: #eef;
            font-size: 14px;
            animation: float 3s ease-in-out infinite;
            cursor: pointer;
            transition: all .3s ease;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-8px); }
        }

        #mainCrystal:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 20px rgba(102,126,234,.3);
        }

        .section-title {
            font-size: 20px;
            font-weight: bold;
            margin: 30px 0 16px;
            color: #333;
            text-align: center;
        }

        /* ===== ÌéòÏù¥ÏßÄ Î∞è Î∑∞ Í¥ÄÎ¶¨ ===== */
        .page {
            display: none;
        }

        .page.show {
            display: block;
        }

        /* ===== ÏÑúÎπÑÏä§ Í∑∏Î¶¨Îìú ===== */
        .service-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
            margin-bottom: 8px;
        }

        .service-item {
            background: linear-gradient(135deg, #ffefd5 0%, #ffd5e5 100%);
            border-radius: 16px;
            padding: 20px 12px;
            text-align: center;
            box-shadow: 0 6px 20px rgba(0,0,0,.08);
            transition: all .2s;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .service-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,.4), transparent);
            transition: left .5s;
        }

        .service-item:hover::before {
            left: 100%;
        }

        .service-item:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 24px rgba(0,0,0,.12);
        }

        .service-icon {
            font-size: 32px;
            margin-bottom: 8px;
            display: block;
        }

        .service-name {
            font-size: 16px;
            font-weight: bold;
            color: #333;
            margin-bottom: 6px;
        }

        .service-desc {
            font-size: 12px;
            color: #666;
            line-height: 1.4;
        }

        .special-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin: 16px 0 24px;
        }

        .special-item {
            background: linear-gradient(135deg, #e3f2fd 0%, #f3e5f5 100%);
            border-radius: 14px;
            padding: 16px;
            text-align: center;
            cursor: pointer;
            transition: all .2s;
        }

        .special-item:hover {
            transform: scale(1.02);
            box-shadow: 0 5px 15px rgba(0,0,0,.1);
        }

        .special-icon {
            font-size: 24px;
            margin-bottom: 8px;
        }

        .special-title {
            font-size: 14px;
            font-weight: bold;
            margin-bottom: 4px;
            color: #333;
        }

        .special-desc {
            font-size: 11px;
            color: #666;
        }

        /* ===== Ïπ¥Îìú Ïä§ÌÉÄÏùº ===== */
        .card {
            background: #fff;
            border: 1px solid #eee;
            border-radius: 14px;
            padding: 16px;
            box-shadow: 0 8px 24px rgba(0,0,0,.06);
            margin-bottom: 20px;
        }

        .field {
            display: flex;
            flex-direction: column;
            gap: 6px;
            margin-bottom: 12px;
        }

        .label {
            font-size: 13px;
            color: #444;
            font-weight: bold;
        }

        .input, select {
            padding: 12px;
            border-radius: 10px;
            border: 1px solid #ddd;
            font-size: 14px;
            background: #fff;
            outline: none;
        }

        .btn {
            display: inline-flex;
            justify-content: center;
            align-items: center;
            gap: 8px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: #fff;
            border: none;
            border-radius: 12px;
            padding: 12px 16px;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 6px 16px rgba(102,126,234,.25);
            transition: transform .1s ease;
            text-decoration: none;
        }

        .btn:active {
            transform: translateY(1px);
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 12px;
            cursor: pointer;
            font-weight: bold;
            margin: 8px;
        }

        .btn-ghost {
            background: #f6f6f6;
            color: #333;
            border: 1px solid #ddd;
        }

        /* ===== ÌïòÎã® ÎÑ§ÎπÑÍ≤åÏù¥ÏÖò ===== */
        #bottomNav {
            position: fixed;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            max-width: 430px;
            width: 100%;
            background: #fff;
            padding: 10px 16px;
            box-shadow: 0 -2px 15px rgba(0,0,0,.1);
            display: none;
            justify-content: space-around;
            border-radius: 16px 16px 0 0;
            z-index: 20;
        }

        #bottomNav.show {
            display: flex;
        }

        .nav-item {
            text-align: center;
            cursor: pointer;
            transition: all .2s;
            padding: 8px;
            border-radius: 12px;
            user-select: none;
        }

        .nav-item:hover {
            background: #f5f5f5;
            transform: translateY(-2px);
        }

        .nav-icon {
            font-size: 20px;
            margin-bottom: 4px;
        }

        .nav-text {
            font-size: 11px;
            color: #666;
        }

        .nav-item.active .nav-text {
            color: #667eea;
            font-weight: bold;
        }

        .nav-item.active .nav-icon {
            color: #667eea;
        }

        /* ===== Í≤∞Í≥º ÏãúÌä∏ ===== */
        #sheetBackdrop {
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,.4);
            display: none;
            align-items: flex-end;
            justify-content: center;
            z-index: 30;
            backdrop-filter: blur(5px);
        }

        #sheetBackdrop.show {
            display: flex;
        }

        .sheet {
            width: 100%;
            max-width: 430px;
            background: #fff;
            border-radius: 20px 20px 0 0;
            max-height: 85vh;
            overflow-y: auto;
            animation: sheetUp .3s ease-out;
            box-shadow: 0 -10px 40px rgba(0,0,0,.2);
        }

        @keyframes sheetUp {
            from { transform: translateY(100%); }
            to { transform: translateY(0); }
        }

        .sheet-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 20px 20px 10px;
            border-bottom: 1px solid #f0f0f0;
            background: linear-gradient(135deg, #f8f9ff 0%, #fff 100%);
        }

        #sheetTitle {
            font-size: 20px;
            font-weight: 700;
            color: #333;
        }

        #btnClose {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            border: none;
            background: rgba(102,126,234,.1);
            color: #667eea;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all .2s ease;
        }

        #btnClose:hover {
            background: rgba(102,126,234,.2);
            transform: scale(1.1);
        }

        #sheetContent {
            padding: 20px;
            line-height: 1.6;
            color: #333;
        }

        .sheet-actions {
            padding: 0 20px 30px;
            display: flex;
            gap: 12px;
            justify-content: center;
        }

        /* ===== Í≤∞Í≥º Ïπ¥Îìú ===== */
        .result-card {
            background: linear-gradient(135deg, #fff 0%, #f8f9ff 100%);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 16px;
            box-shadow: 0 8px 24px rgba(0,0,0,0.08);
            border: 1px solid rgba(102, 126, 234, 0.1);
            position: relative;
            overflow: hidden;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .result-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 32px rgba(0,0,0,0.12);
        }

        .card-header {
            display: flex;
            align-items: center;
            margin-bottom: 12px;
        }

        .card-icon {
            font-size: 20px;
            margin-right: 12px;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }

        .card-title {
            font-size: 16px;
            font-weight: bold;
            color: #333;
        }

        .card-value {
            font-size: 20px;
            font-weight: 800;
            color: #667eea;
            margin: 8px 0;
        }

        .card-description {
            font-size: 14px;
            line-height: 1.6;
            color: #555;
        }

        .card-description strong {
            color: #667eea;
            font-weight: 700;
        }

        .section-title-result {
            font-size: 18px;
            font-weight: bold;
            color: #333;
            margin-bottom: 16px;
            padding-left: 12px;
            border-left: 4px solid #667eea;
        }

        .result-section {
            margin-bottom: 24px;
        }

        /* ===== Ï†ïÎ≥¥ Î∞ïÏä§ ===== */
        .info-box {
            background: rgba(102, 126, 234, 0.05);
            border: 1px dashed rgba(102, 126, 234, 0.3);
            border-radius: 12px;
            padding: 16px;
            margin-top: 20px;
        }

        .info-title {
            font-size: 14px;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 8px;
        }

        .info-content {
            font-size: 13px;
            line-height: 1.5;
            color: #666;
        }

        /* ===== Î°úÎòê Ïä§ÌÉÄÏùº ===== */
        .lotto-wrap {
            text-align: center;
        }

        .lotto-balls {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
            margin: 10px 0 6px;
        }

        .ball {
            width: 44px;
            height: 44px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 800;
            color: #fff;
            background: linear-gradient(135deg, #667eea, #764ba2);
            box-shadow: 0 6px 16px rgba(0,0,0,.18);
        }

        .ball.bonus {
            background: linear-gradient(135deg, #ff9800, #ffc107);
        }

        .lotto-meta {
            color: #666;
            font-size: 12px;
            margin-top: 6px;
        }

        /* ===== ÌÉÄÎ°ú Ïπ¥Îìú ===== */
        .tarot-card-selection {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 16px;
            padding: 20px 0;
        }

        .tarot-row {
            display: flex;
            justify-content: center;
            gap: 12px;
            flex-wrap: wrap;
        }

        .tarot-card-back {
            width: 70px;
            height: 105px;
            background: linear-gradient(145deg, #2c3e50 0%, #34495e 100%);
            border-radius: 12px;
            border: 3px solid #667eea;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            box-shadow: 0 8px 25px rgba(0,0,0,0.15), inset 0 1px 3px rgba(255,255,255,0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            transform-style: preserve-3d;
        }

        .tarot-card-back:hover {
            transform: translateY(-8px) scale(1.05);
            box-shadow: 0 15px 35px rgba(0,0,0,0.25), 0 0 20px rgba(102,126,234,0.4);
            border-color: #ffd700;
        }

        .card-back-design {
            font-size: 22px;
            color: #ffd700;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
            filter: drop-shadow(0 0 8px rgba(255,215,0,0.3));
            animation: twinkle 2s ease-in-out infinite;
        }

        @keyframes twinkle {
            0%, 100% { opacity: 0.7; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.1); }
        }

        .tarot-card-front {
            position: absolute;
            inset: 0;
            background: #fff;
            border-radius: 9px;
            padding: 6px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            font-size: 9px;
            color: #333;
            border: 2px solid #ffd700;
            box-shadow: inset 0 2px 8px rgba(255,215,0,0.2);
            transform: rotateY(180deg);
            backface-visibility: hidden;
            opacity: 0;
            transition: opacity 0.5s ease;
        }

        .tarot-card-back.revealed .tarot-card-front {
            opacity: 1;
        }

        .tarot-card-back.flipped {
            transform: rotateY(180deg);
        }

        .tarot-actions {
            margin-top: 20px;
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
        }

        /* ===== ÌÉÄÎ°ú Î™®Îã¨ ===== */
        #tarotModalOverlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.8);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 20px;
            backdrop-filter: blur(5px);
        }

        #tarotModalOverlay.show {
            display: flex;
        }

        .tarot-modal {
            background: linear-gradient(145deg, #2c3e50 0%, #34495e 100%);
            border-radius: 20px;
            padding: 30px;
            max-width: 500px;
            width: 100%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 25px 60px rgba(0,0,0,0.8), inset 0 2px 5px rgba(255,255,255,0.1);
            border: 2px solid #667eea;
            position: relative;
            color: white;
            animation: modalIn 0.3s ease-out;
        }

        @keyframes modalIn {
            from {
                opacity: 0;
                transform: scale(0.9) translateY(-20px);
            }
            to {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }

        #tarotCloseBtn {
            position: absolute;
            top: 15px;
            right: 20px;
            background: none;
            border: none;
            color: #ffd700;
            font-size: 24px;
            cursor: pointer;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
        }

        #tarotCloseBtn:hover {
            background: rgba(255,215,0,0.1);
            transform: scale(1.1);
        }

        /* ===== Îü≠ÌÇ§ ÏïÑÏù¥ÌÖú Í∑∏Î¶¨Îìú ===== */
        .lucky-items-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .lucky-item-card {
            background: linear-gradient(135deg, #f8f9ff, #e8f4ff);
            border: 2px solid #e0e7ff;
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            transition: transform 0.2s ease;
        }

        .lucky-item-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.2);
        }

        .lucky-icon {
            font-size: 24px;
            margin-bottom: 8px;
        }

        .lucky-label {
            font-size: 12px;
            color: #666;
            margin-bottom: 5px;
        }

        .lucky-value {
            font-weight: bold;
            color: #333;
            font-size: 16px;
        }

        .fortune-date {
            text-align: center;
            color: #667eea;
            font-weight: bold;
            margin-bottom: 20px;
            font-size: 16px;
        }

        .spacer {
            height: 100px;
        }

        /* ===== Î∞òÏùëÌòï ===== */
        @media (max-width: 768px) {
            .service-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 12px;
            }
            
            .tarot-card-back {
                width: 60px;
                height: 90px;
            }
            
            .card-back-design {
                font-size: 18px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Ïä§ÌîåÎûòÏãú ÌôîÎ©¥ -->
        <div id="splashScreen" aria-label="MysticTell Splash">
            <button class="start-image-btn" id="startBtn" aria-label="Start"></button>
        </div>

        <!-- Î©îÏù∏ ÏΩòÌÖêÏ∏† -->
        <div id="mainContent">
            <div class="header">
                <div class="logo">üîÆ MysticTell</div>
                <div class="subtitle">Ïã†ÎπÑÎ°úÏö¥ ÎØ∏ÎûòÎ•º ÏïåÎ†§ÎìúÎ¶¨Îäî ÎîîÏßÄÌÑ∏ Ï†êÏà†ÏÇ¨</div>
                <div id="mainCrystal">Íµ¨Ïä¨ ÏÜç ÎØ∏ÎûòÎ•º<br/>ÌôïÏù∏Ìï¥Î≥¥ÏÑ∏Ïöî</div>
            </div>

            <!-- Ìôà ÌéòÏù¥ÏßÄ -->
            <section id="page-home" class="page show">
                <div class="section-title">‚ú® ÌïµÏã¨ Ïö¥ÏÑ∏ ÏÑúÎπÑÏä§</div>
                <div class="service-grid">
                    <div class="service-item" data-route="fortune-today">
                        <span class="service-icon">üóìÔ∏è</span>
                        <div class="service-name">Ïò§ÎäòÏùò Ïö¥ÏÑ∏</div>
                        <div class="service-desc">Îß§Ïùº ÏÉàÎ°úÏö¥ Ïö¥ÏÑ∏Î•º ÌôïÏù∏ÌïòÏÑ∏Ïöî</div>
                    </div>
                    <div class="service-item" data-route="fortune-lotto">
                        <div class="service-icon">üé≤</div>
                        <div class="service-name">ÌñâÏö¥Î≤àÌò∏</div>
                        <div class="service-desc">ÌÜµÍ≥Ñ Í∏∞Î∞ò Î°úÎòê Î≤àÌò∏</div>
                    </div>
                    <div class="service-item" data-route="fortune-saju">
                        <span class="service-icon">üìú</span>
                        <div class="service-name">Ï†ïÌÜµ ÏÇ¨Ï£º</div>
                        <div class="service-desc">ÏÉùÎÖÑÏõîÏùºÎ°ú Î≥¥Îäî Ïù∏ÏÉù Ïö¥ÏÑ∏</div>
                    </div>
                    <div class="service-item" data-route="fortune-tarot">
                        <span class="service-icon">üÉè</span>
                        <div class="service-name">ÌÉÄÎ°ú Ï†ê</div>
                        <div class="service-desc">Ïπ¥ÎìúÍ∞Ä Ï†ÑÌïòÎäî ÎØ∏Îûò Î©îÏãúÏßÄ</div>
                    </div>
                </div>

                <div class="section-title">üåü ÌäπÎ≥Ñ ÏÑúÎπÑÏä§</div>
                <div class="special-grid">
                    <div class="special-item" data-route="fortune-match">
                        <div class="special-icon">üíï</div>
                        <div class="special-title">Í∂ÅÌï© Î≥¥Í∏∞</div>
                        <div class="special-desc">Îëê ÏÇ¨ÎûåÏùò Ïö¥Î™ÖÏ†Å ÎßåÎÇ®</div>
                    </div>
                    <div class="special-item" data-route="fortune-year">
                        <div class="special-icon">üéä</div>
                        <div class="special-title">Ïã†ÎÖÑ Ïö¥ÏÑ∏</div>
                        <div class="special-desc">2025ÎÖÑ Ìïú Ìï¥ Ïö¥ÏÑ∏</div>
                    </div>
                </div>
            </section>

            <!-- Ïö¥ÏÑ∏ ÌéòÏù¥ÏßÄ -->
            <section id="page-fortune" class="page">
                <div class="section-title" id="fortuneTitle">Ïö¥ÏÑ∏</div>

                <!-- Ïò§ÎäòÏùò Ïö¥ÏÑ∏ -->
                <div id="view-today" class="card" style="display:none;">
                    <div class="field">
                        <div class="label">ÏÉùÎÖÑÏõîÏùº</div>
                        <input class="input" type="date" id="today-birth" />
                    </div>
                    <div class="field">
                        <div class="label">Ïù¥Î¶Ñ (ÏÑ†ÌÉù)</div>
                        <input class="input" type="text" id="today-name" placeholder="Ïù¥Î¶ÑÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî" />
                    </div>
                    <div class="field">
                        <div class="label">Îã¨Î†•</div>
                        <div style="display: flex; gap: 10px; align-items: center;">
                            <label><input type="radio" name="today-cal" id="today-cal-solar" value="solar" checked> ÏñëÎ†•</label>
                            <label><input type="radio" name="today-cal" id="today-cal-lunar" value="lunar"> ÏùåÎ†•</label>
                            <label style="margin-left:8px;"><input type="checkbox" id="today-leap"> Ïú§Îã¨</label>
                        </div>
                    </div>
                    <button class="btn" id="btnToday">Ïò§ÎäòÏùò Ïö¥ÏÑ∏ Î≥¥Í∏∞</button>
                </div>

                <!-- Ï†ïÌÜµ ÏÇ¨Ï£º -->
                <div id="view-saju" class="card" style="display:none;">
                    <div class="field">
                        <div class="label">ÏÉùÎÖÑÏõîÏùº</div>
                        <input class="input" type="date" id="saju-birth" />
                    </div>
                    <div class="field">
                        <div class="label">Ïù¥Î¶Ñ (ÏÑ†ÌÉù)</div>
                        <input class="input" type="text" id="saju-name" placeholder="Ïù¥Î¶ÑÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî" />
                    </div>
                    <div class="field">
                        <div class="label">ÏÑ±Î≥Ñ</div>
                        <select id="saju-gender" class="input">
                            <option value="F">Ïó¨ÏÑ±</option>
                            <option value="M">ÎÇ®ÏÑ±</option>
                        </select>
                    </div>
                    <div class="field">
                        <div class="label">ÌÉúÏñ¥ÎÇú ÏãúÍ∞Ñ (ÏÑ†ÌÉù)</div>
                        <input class="input" type="time" id="saju-time" step="900" placeholder="Ïòà: 13:30" />
                    </div>
                    <div class="field">
                        <div class="label">Îã¨Î†•</div>
                        <div style="display: flex; gap: 10px; align-items: center;">
                            <label><input type="radio" name="saju-cal" id="saju-cal-solar" value="solar" checked> ÏñëÎ†•</label>
                            <label><input type="radio" name="saju-cal" id="saju-cal-lunar" value="lunar"> ÏùåÎ†•</label>
                            <label style="margin-left:8px;"><input type="checkbox" id="saju-leap"> Ïú§Îã¨</label>
                        </div>
                    </div>
                    <button class="btn" id="btnSaju">ÏÇ¨Ï£º Ìï¥ÏÑù Î≥¥Í∏∞</button>
                </div>

                <!-- ÌñâÏö¥Î≤àÌò∏ -->
                <div id="view-lotto" class="card" style="display:none;">
                    <h3 style="margin-bottom: 20px; text-align: center; color: #667eea;">üé≤ ÌñâÏö¥Ïùò Î°úÎòêÎ≤àÌò∏</h3>
                    <p style="text-align: center; color: #666; margin-bottom: 25px; font-style: italic;">
                        Ïã§Ï†ú ÌÜµÍ≥Ñ + Í∞úÏù∏ ÌñâÏö¥Ïàò Ï°∞Ìï©
                    </p>
                    <div class="field">
                        <div class="label">ÏÉùÎÖÑÏõîÏùº (ÏÑ†ÌÉùÏÇ¨Ìï≠)</div>
                        <input type="text" id="lotto-birth" placeholder="1990-01-01" class="input">
                        <small style="color: #666;">Í∞úÏù∏ÎßûÏ∂§ ÌñâÏö¥Î≤àÌò∏Î•º ÏúÑÌï¥ ÏûÖÎ†•ÌïòÏÑ∏Ïöî!</small>
                    </div>
                    <button id="btnLotto" class="btn">
                        üé≤ ÌñâÏö¥Î≤àÌò∏ ÏÉùÏÑ±ÌïòÍ∏∞
                    </button>
                    <div style="margin-top: 16px; font-size: 12px; color: #666; text-align: center;">
                        üí° Í∞ÄÏû• ÏûêÏ£º ÎÇòÏò® Î≤àÌò∏Îì§Í≥º Í∞úÏù∏ ÌñâÏö¥ÏàòÏùò Ï°∞Ìï©
                    </div>
                </div>

                <!-- ÌÉÄÎ°ú -->
                <div id="view-tarot" class="card" style="display:none;">
                    <h3 style="margin-bottom: 20px; text-align: center; color: #667eea;">üîÆ ÌÉÄÎ°ú Ïπ¥Îìú Ï†ê</h3>
                    <p style="text-align: center; color: #666; margin-bottom: 25px; font-style: italic;">
                        üåü ÎßàÏùåÏùÑ ÏßëÏ§ëÌïòÍ≥† Ïπ¥ÎìúÎ•º ÏÑ†ÌÉùÌïòÏÑ∏Ïöî
                    </p>
                    
                    <div class="tarot-card-selection">
                        <div class="tarot-row">
                            <div class="tarot-card-back" data-card-index="0">
                                <div class="card-back-design">üåü</div>
                            </div>
                            <div class="tarot-card-back" data-card-index="1">
                                <div class="card-back-design">üåü</div>
                            </div>
                            <div class="tarot-card-back" data-card-index="2">
                                <div class="card-back-design">üåü</div>
                            </div>
                            <div class="tarot-card-back" data-card-index="3">
                                <div class="card-back-design">üåü</div>
                            </div>
                        </div>
                        <div class="tarot-row">
                            <div class="tarot-card-back" data-card-index="4">
                                <div class="card-back-design">üåü</div>
                            </div>
                            <div class="tarot-card-back" data-card-index="5">
                                <div class="card-back-design">üåü</div>
                            </div>
                            <div class="tarot-card-back" data-card-index="6">
                                <div class="card-back-design">üåü</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="tarot-actions">
                        <button id="btnRandomTarot" class="btn" style="background: linear-gradient(135deg, #8e44ad, #9b59b6);">
                            üé≤ ÎûúÎç§ ÎΩëÍ∏∞
                        </button>
                        <button id="btnResetTarot" class="btn btn-ghost">üîÑ Îã§Ïãú ÏãúÏûë</button>
                    </div>
                </div>

                <!-- Í∂ÅÌï© Î≥¥Í∏∞ -->
                <div id="view-match" class="card" style="display:none;">
                    <div class="field">
                        <div class="label">ÎãπÏã†Ïùò ÏÉùÎÖÑÏõîÏùº</div>
                        <input class="input" type="date" id="match-a" />
                    </div>
                    <div class="field">
                        <div class="label">ÏÉÅÎåÄÏùò ÏÉùÎÖÑÏõîÏùº</div>
                        <input class="input" type="date" id="match-b" />
                    </div>
                    <button class="btn" id="btnMatch">Í∂ÅÌï© ÌôïÏù∏</button>
                </div>

                <!-- Ïã†ÎÖÑ Ïö¥ÏÑ∏ -->
                <div id="view-year" class="card" style="display:none;">
                    <div class="field">
                        <div class="label">ÏÉùÎÖÑÏõîÏùº</div>
                        <input class="input" type="date" id="year-birth" />
                    </div>
                    <button class="btn" id="btnYear">2025 Ïã†ÎÖÑ Ïö¥ÏÑ∏</button>
                </div>
            </section>

            <!-- ÏÉÅÎã¥ ÌéòÏù¥ÏßÄ -->
            <section id="page-chat" class="page">
                <div class="card">
                    <div class="label" style="margin-bottom:8px;">ÏÉÅÎã¥ Ï§ÄÎπÑÏ§ë</div>
                    <div style="font-size:14px;color:#555;">Í≥ß Ï†ÑÎ¨∏Í∞ÄÏôÄ 1:1 ÏÉÅÎã¥ Í∏∞Îä•Ïù¥ Ïó¥Î¶ΩÎãàÎã§.</div>
                </div>
            </section>

            <!-- ÎßàÏù¥ ÌéòÏù¥ÏßÄ -->
            <section id="page-me" class="page">
                <div class="card">
                    <div class="label" style="margin-bottom:8px;">ÎßàÏù¥ ÌéòÏù¥ÏßÄ(Î°úÏª¨)</div>
                    <div style="font-size:14px;color:#555;">ÏµúÍ∑º Í≤∞Í≥ºÍ∞Ä Ïù¥ Í∏∞Í∏∞(Î∏åÎùºÏö∞Ï†Ä)Ïóê Ï†ÄÏû•Îê©ÎãàÎã§.</div>
                    <button class="btn" id="btnClear" style="margin-top:12px;">ÏµúÍ∑º Í≤∞Í≥º Î™®Îëê ÏÇ≠Ï†ú</button>
                </div>
            </section>

            <div class="spacer"></div>
        </div>

        <!-- ÌïòÎã® ÎÑ§ÎπÑÍ≤åÏù¥ÏÖò -->
        <div id="bottomNav">
            <div class="nav-item active" data-tab="home">
                <div class="nav-icon">üè†</div>
                <div class="nav-text">Ìôà</div>
            </div>
            <div class="nav-item" data-tab="fortune">
                <div class="nav-icon">üîÆ</div>
                <div class="nav-text">Ïö¥ÏÑ∏</div>
            </div>
            <div class="nav-item" data-tab="chat">
                <div class="nav-icon">üí¨</div>
                <div class="nav-text">ÏÉÅÎã¥</div>
            </div>
            <div class="nav-item" data-tab="me">
                <div class="nav-icon">üë§</div>
                <div class="nav-text">ÎßàÏù¥</div>
            </div>
        </div>
    </div>

    <!-- Í≤∞Í≥º ÏãúÌä∏ -->
    <div id="sheetBackdrop" role="dialog" aria-modal="true" aria-labelledby="sheetTitle">
        <div class="sheet" role="document">
            <div class="sheet-header">
                <div id="sheetTitle">Í≤∞Í≥º</div>
                <button id="btnClose">‚úï</button>
            </div>
            <div id="sheetContent">ÎÇ¥Ïö©</div>
            <div class="sheet-actions">
                <button class="btn" id="btnSave">ÏµúÍ∑º Í≤∞Í≥º Ï†ÄÏû•</button>
            </div>
        </div>
    </div>

    <!-- ÌÉÄÎ°ú Î™®Îã¨ -->
    <div id="tarotModalOverlay">
        <div class="tarot-modal" id="tarotModal">
            <button id="tarotCloseBtn">‚úï</button>
            <div id="tarotModalContent">
                <!-- Î™®Îã¨ ÎÇ¥Ïö©Ïù¥ JavaScriptÎ°ú Ï±ÑÏõåÏßê -->
            </div>
        </div>
    </div>

    <!-- ÎùºÏù¥Î∏åÎü¨Î¶¨ -->
    <script src="https://cdn.jsdelivr.net/npm/lunar-javascript@1.6.12/lunar.min.js"></script>
    
    <!-- Î©îÏù∏ JavaScript -->
    <script>
        // ===========================================
        // Ï†ÑÏó≠ Î≥ÄÏàò Î∞è Ìó¨Ìçº Ìï®Ïàò
        // ===========================================
        const $ = (sel) => document.querySelector(sel);
        const $$ = (sel) => Array.from(document.querySelectorAll(sel));
        const LS_KEY = 'mystictell_recent_results';

        // ===========================================
        // Ïä§ÌîåÎûòÏãú Í¥ÄÎ¶¨
        // ===========================================
        function hideSplash() {
            const splash = $('#splashScreen');
            const main = $('#mainContent');
            const nav = $('#bottomNav');

            console.log('üîÆ Ïä§ÌîåÎûòÏãú Ïà®ÍπÄ ÏãúÏûë...');

            if (splash) {
                splash.classList.add('hidden');
                console.log('‚úÖ Ïä§ÌîåÎûòÏãú Ïä§ÌÅ¨Î¶∞ Ïà®ÍπÄ ÏôÑÎ£å');
            }

            if (main) {
                main.style.display = 'block';
                main.classList.add('show');
                console.log('‚úÖ Î©îÏù∏ ÏΩòÌÖêÏ∏† ÌëúÏãú ÏôÑÎ£å');
            }

            if (nav) {
                nav.style.display = 'flex';
                nav.classList.add('show');
                console.log('‚úÖ ÎÑ§ÎπÑÍ≤åÏù¥ÏÖò ÌëúÏãú ÏôÑÎ£å');
            }
        }

        // ===========================================
        // ÌéòÏù¥ÏßÄ Î∞è Î∑∞ Í¥ÄÎ¶¨
        // ===========================================
        const pages = {
            home: () => $('#page-home'),
            fortune: () => $('#page-fortune'),
            chat: () => $('#page-chat'),
            me: () => $('#page-me')
        };

        const views = {
            'fortune-today': $('#view-today'),
            'fortune-saju': $('#view-saju'),
            'fortune-tarot': $('#view-tarot'),
            'fortune-match': $('#view-match'),
            'fortune-year': $('#view-year'),
            'fortune-lotto': $('#view-lotto')
        };

        function setActiveTab(tab) {
            // ÌÉ≠ ÌôúÏÑ±Ìôî
            $$('.nav-item').forEach(n => n.classList.toggle('active', n.dataset.tab === tab));
            
            // ÌéòÏù¥ÏßÄ ÌëúÏãú
            Object.entries(pages).forEach(([k, pageGetter]) => {
                const page = pageGetter();
                if (page) {
                    page.classList.toggle('show', k === tab);
                    page.style.display = k === tab ? 'block' : 'none';
                }
            });
            
            closeAllOverlays();
        }

        function showFortuneView(route) {
            const fortuneTitle = $('#fortuneTitle');
            
            // Î™®Îì† Î∑∞ Ïà®Í∏∞Í∏∞
            Object.values(views).forEach(v => {
                if (v) v.style.display = 'none';
            });
            
            // ÏÑ†ÌÉùÎêú Î∑∞ ÌëúÏãú
            const viewElement = views[route];
            if (viewElement) {
                viewElement.style.display = 'block';
            }
            
            // Ï†úÎ™© ÏÑ§Ï†ï
            const titles = {
                'fortune-today': 'Ïò§ÎäòÏùò Ïö¥ÏÑ∏',
                'fortune-saju': 'Ï†ïÌÜµ ÏÇ¨Ï£º',
                'fortune-tarot': 'ÌÉÄÎ°ú Ï†ê',
                'fortune-match': 'Í∂ÅÌï© Î≥¥Í∏∞',
                'fortune-year': 'Ïã†ÎÖÑ Ïö¥ÏÑ∏ (2025)',
                'fortune-lotto': 'ÌñâÏö¥Î≤àÌò∏'
            };
            
            if (fortuneTitle) {
                fortuneTitle.textContent = titles[route] || 'Ï§ÄÎπÑÏ§ë';
            }
            
            // ÌäπÎ≥Ñ Ï¥àÍ∏∞Ìôî
            if (route === 'fortune-tarot') {
                setTimeout(() => initializeTarot(), 50);
            }
            
            reactCrystal(`${titles[route] || 'ÏÑúÎπÑÏä§'}Î•º Ï§ÄÎπÑÌï©ÎãàÎã§...`);
        }

        // ===========================================
        // ÎùºÏö∞ÌåÖ
        // ===========================================
        function routeFromHash() {
            const hash = location.hash || '#/home';
            const match = hash.match(/^#\/([^/]+)(?:\/([^/]+))?/);
            const tab = match?.[1] || 'home';
            const sub = match?.[2] || '';

            console.log('üîÑ ÎùºÏö∞ÌåÖ:', tab, sub);

            // ÌÉ≠ ÏÑ§Ï†ï
            if (['home', 'fortune', 'chat', 'me'].includes(tab)) {
                setActiveTab(tab);
            } else {
                setActiveTab('home');
            }

            // Ïö¥ÏÑ∏ ÏÑúÎ∏åÎ∑∞ ÏÑ§Ï†ï
            if (tab === 'fortune') {
                const viewMap = {
                    'today': 'fortune-today',
                    'saju': 'fortune-saju',
                    'tarot': 'fortune-tarot',
                    'match': 'fortune-match',
                    'year': 'fortune-year',
                    'lotto': 'fortune-lotto'
                };
                showFortuneView(viewMap[sub] || 'fortune-today');
            }
        }

        // ===========================================
        // ÌÅ¨Î¶¨Ïä§ÌÉà Î∞òÏùë
        // ===========================================
        function reactCrystal(text) {
            const crystal = $('#mainCrystal');
            if (!crystal) return;
            
            crystal.style.background = 'radial-gradient(circle at 30% 30%, rgba(255,215,0,.9), rgba(255,20,147,.7), rgba(138,43,226,.5))';
            crystal.innerHTML = 'üîÆ<br>Î∂ÑÏÑùÏ§ë...';
            
            setTimeout(() => {
                crystal.innerHTML = text || '‚ú® Ï§ÄÎπÑÏ§ëÏûÖÎãàÎã§...';
            }, 800);
            
            setTimeout(() => {
                crystal.style.background = 'radial-gradient(circle at 30% 30%, rgba(255,255,255,.8), rgba(255,255,255,.3), transparent)';
                crystal.innerHTML = 'Íµ¨Ïä¨ ÏÜç ÎØ∏ÎûòÎ•º<br>ÌôïÏù∏Ìï¥Î≥¥ÏÑ∏Ïöî';
            }, 2800);
        }

        // ===========================================
        // ÏãúÌä∏ Í¥ÄÎ¶¨
        // ===========================================
        const sheet = $('#sheetBackdrop');
        const sheetTitle = $('#sheetTitle');
        const sheetContent = $('#sheetContent');
        let lastResult = null;

        function openSheet(title, content, savePayload) {
            if (!sheet || !sheetTitle || !sheetContent) return;
            
            sheetTitle.textContent = title;
            
            if (typeof content === 'string' && content.includes('<')) {
                sheetContent.innerHTML = content;
            } else {
                sheetContent.textContent = content?.toString?.() || '';
            }
            
            sheet.classList.add('show');
            lastResult = savePayload || null;
            document.body.style.overflow = 'hidden';
        }

        function closeSheet() {
            if (!sheet) return;
            sheet.classList.remove('show');
            document.body.style.overflow = '';
        }

        function closeAllOverlays() {
            closeSheet();
            closeTarotModal();
        }

        // ===========================================
        // Î°úÏª¨Ïä§ÌÜ†Î¶¨ÏßÄ Í¥ÄÎ¶¨
        // ===========================================
        function pushRecent(item) {
            try {
                const arr = JSON.parse(localStorage.getItem(LS_KEY) || "[]");
                arr.unshift({ ...item, ts: Date.now() });
                localStorage.setItem(LS_KEY, JSON.stringify(arr.slice(0, 20)));
            } catch (e) {
                console.warn('LocalStorage error:', e);
            }
        }

        // ===========================================
        // Ïö¥ÏÑ∏ Îç∞Ïù¥ÌÑ∞
        // ===========================================
        const FORTUNE_CATEGORIES = {
            total: {
                name: 'Ï¥ùÏö¥',
                icon: 'üåü',
                messages: {
                    90: ['Ïò§ÎäòÏùÄ Î™®Îì† ÏùºÏù¥ Ïà†Ïà† ÌíÄÎ¶¨Îäî ÏµúÍ≥†Ïùò ÎÇ†ÏûÖÎãàÎã§!', 'ÌñâÏö¥Ïùò Ïó¨Ïã†Ïù¥ Ìï®ÍªòÌïòÎäî ÌäπÎ≥ÑÌïú ÌïòÎ£®Í∞Ä Îê† Í≤ÉÏûÖÎãàÎã§!'],
                    80: ['Í∏çÏ†ïÏ†ÅÏù∏ ÏóêÎÑàÏßÄÍ∞Ä ÎÑòÏπòÎäî Ï¢ãÏùÄ ÎÇ†ÏûÖÎãàÎã§!', 'ÏûëÏùÄ Í∏∞Ï†ÅÎì§Ïù¥ ÏùºÏñ¥ÎÇ† Ïàò ÏûàÎäî ÎÇ†ÏûÖÎãàÎã§!'],
                    70: ['ÏïàÏ†ïÏ†ÅÏù¥Í≥† ÌèâÌôîÎ°úÏö¥ ÌïòÎ£®Í∞Ä Îê† Í≤ÉÏûÖÎãàÎã§!', 'Ï∞®Í∑ºÏ∞®Í∑º ÏßÑÌñâÌïòÎ©¥ Ï¢ãÏùÄ ÏÑ±Í≥ºÎ•º ÏñªÏùÑ Ïàò ÏûàÏäµÎãàÎã§!'],
                    60: ['Ï°∞Í∏àÎßå Îçî ÎÖ∏Î†•ÌïòÎ©¥ ÏõêÌïòÎäî Í≤∞Í≥ºÎ•º ÏñªÏùÑ Ïàò ÏûàÏäµÎãàÎã§!', 'Ïù∏ÎÇ¥Ïã¨ÏùÑ Í∞ñÍ≥† Íæ∏Ï§ÄÌûà ÎÇòÏïÑÍ∞ÄÏÑ∏Ïöî!'],
                    50: ['ÌòÑÏÉÅ Ïú†ÏßÄÌïòÎ©∞ ÏïàÏ†ÑÌïòÍ≤å ÏßÄÎÇ¥Îäî Í≤ÉÏù¥ Ï¢ãÍ≤†ÏäµÎãàÎã§!', 'Í∏âÌïòÍ≤å ÏÑúÎëêÎ•¥ÏßÄ ÎßêÍ≥† Ïã†Ï§ëÌïòÍ≤å ÌåêÎã®ÌïòÏÑ∏Ïöî!'],
                    40: ['Ï°∞Ïã¨Ïä§ÎüΩÍ≤å ÌñâÎèôÌïòÍ≥† Ïã†Ï§ëÌïú Í≤∞Ï†ïÏùÑ ÎÇ¥Î¶¨ÏÑ∏Ïöî!', 'ÏûëÏùÄ ÏùºÎ∂ÄÌÑ∞ Ï∞®Í∑ºÏ∞®Í∑º Ìï¥Í≤∞Ìï¥ÎÇòÍ∞ÄÏÑ∏Ïöî!'],
                    30: ['Ïò§ÎäòÏùÄ Î¨¥Î¶¨ÌïòÏßÄ ÎßêÍ≥† Ïó¨Ïú†Î°≠Í≤å ÏßÄÎÇ¥ÏÑ∏Ïöî!', 'Ïä§Ìä∏Î†àÏä§Î•º Ï§ÑÏù¥Í≥† ÎßàÏùåÏùò ÌèâÌôîÎ•º Ï∞æÏúºÏÑ∏Ïöî!']
                }
            },
            love: {
                name: 'Ïó∞Ïï†Ïö¥',
                icon: 'üíï',
                messages: {
                    90: ['Ïö¥Î™ÖÏ†ÅÏù∏ ÎßåÎÇ®Ïù¥ Í∏∞Îã§Î¶¨Í≥† ÏûàÏùÑÏßÄÎèÑ Î™∞ÎùºÏöî!', 'ÏÇ¨ÎûëÌïòÎäî ÏÇ¨ÎûåÍ≥ºÏùò Í¥ÄÍ≥ÑÍ∞Ä ÌïúÏ∏µ Îçî ÍπäÏñ¥Ïßà Í≤ÉÏûÖÎãàÎã§!'],
                    80: ['Îã¨ÏΩ§Ìïú ÏÇ¨ÎûëÏùò Í∏∞Ïö¥Ïù¥ Í∞ÄÎìùÌïú ÌïòÎ£®ÏûÖÎãàÎã§!', 'Ï¢ãÏïÑÌïòÎäî ÏÇ¨ÎûåÍ≥ºÏùò Í±∞Î¶¨Í∞Ä Í∞ÄÍπåÏõåÏßà Í≤ÉÏûÖÎãàÎã§!'],
                    70: ['Îî∞ÎúªÌïú ÎßàÏùåÏùÑ ÎÇòÎàÑÎäî ÌèâÏò®Ìïú Ïó∞Ïï†Ïö¥ÏûÖÎãàÎã§!', 'ÏÑúÎ°úÎ•º Ïù¥Ìï¥ÌïòÍ≥† Î∞∞Î†§ÌïòÎäî ÏãúÍ∞ÑÏùÑ Í∞ÄÏ†∏Î≥¥ÏÑ∏Ïöî!'],
                    60: ['Ï°∞Í∏à Îçî Ï†ÅÍ∑πÏ†ÅÏúºÎ°ú ÎßàÏùåÏùÑ ÌëúÌòÑÌï¥Î≥¥ÏÑ∏Ïöî!', 'ÏÉÅÎåÄÎ∞©Ïùò ÏûÖÏû•ÏóêÏÑú ÏÉùÍ∞ÅÌï¥Î≥¥Îäî Í≤ÉÏù¥ Ï§ëÏöîÌï©ÎãàÎã§!'],
                    50: ['ÏÑ£Î∂ÄÎ•∏ Í≥†Î∞±Î≥¥Îã§Îäî Ï≤úÏ≤úÌûà Í¥ÄÍ≥ÑÎ•º Î∞úÏ†ÑÏãúÌÇ§ÏÑ∏Ïöî!', 'Í∞êÏ†ïÏ†ÅÏù∏ ÌåêÎã®Î≥¥Îã§Îäî Ïù¥ÏÑ±Ï†ÅÏù∏ Ï†ëÍ∑ºÏù¥ ÌïÑÏöîÌï©ÎãàÎã§!'],
                    40: ['Ïó∞Ïï†Î≥¥Îã§Îäî ÏûêÍ∏∞Í≥ÑÎ∞úÏóê ÏßëÏ§ëÌïòÎäî Í≤ÉÏù¥ Ï¢ãÍ≤†ÏäµÎãàÎã§!', 'Í∞àÎì±Ïù¥ ÏÉùÍ∏∏ Ïàò ÏûàÏúºÎãà ÎßêÏ°∞Ïã¨ÌïòÏÑ∏Ïöî!'],
                    30: ['Ïò§ÎäòÏùÄ Ïó∞Ïï† Î¨∏Ï†úÎ°ú Ïä§Ìä∏Î†àÏä§Î∞õÏßÄ ÎßàÏÑ∏Ïöî!', 'ÏπúÍµ¨Îì§Í≥ºÏùò ÏãúÍ∞ÑÏùÑ Îçî ÏÜåÏ§ëÌûà Ïó¨Í∏∞ÏÑ∏Ïöî!']
                }
            },
            money: {
                name: 'Ïû¨Î¨ºÏö¥',
                icon: 'üí∞',
                messages: {
                    90: ['ÏòàÏÉÅÏπò Î™ªÌïú ÏàòÏûÖÏù¥ÎÇò Î≥¥ÎÑàÏä§Í∞Ä ÏûàÏùÑ Ïàò ÏûàÏäµÎãàÎã§!', 'Ìà¨ÏûêÎÇò ÏÇ¨ÏóÖÏóêÏÑú ÌÅ∞ ÏÑ±Í≥ºÎ•º Í±∞Îëò Í≤ÉÏûÖÎãàÎã§!'],
                    80: ['Îèà Í¥ÄÎ¶¨Î•º ÏûòÌïòÎ©¥ Î™©ÎèàÏùÑ ÎßåÎì§ Ïàò ÏûàÏùÑ Í≤ÉÏûÖÎãàÎã§!', 'Î∂ÄÏóÖÏù¥ÎÇò ÏÇ¨Ïù¥Îìú ÌîÑÎ°úÏ†ùÌä∏ÏóêÏÑú ÏàòÏùµÏù¥ ÏÉùÍ∏∏ Ïàò ÏûàÏäµÎãàÎã§!'],
                    70: ['ÏïàÏ†ïÏ†ÅÏù∏ ÏàòÏûÖÍ≥º ÏßÄÏ∂ú Í¥ÄÎ¶¨Í∞Ä Ïù¥Î£®Ïñ¥Ïßà Í≤ÉÏûÖÎãàÎã§!', 'Í≥ÑÌöçÏ†ÅÏù∏ Ï†ÄÏ∂ïÏúºÎ°ú ÎØ∏ÎûòÎ•º Ï§ÄÎπÑÌïòÏÑ∏Ïöî!'],
                    60: ['Í∞ÄÍ≥ÑÎ∂ÄÎ•º ÏûëÏÑ±ÌïòÎ©∞ ÎèàÏùò ÌùêÎ¶ÑÏùÑ ÌååÏïÖÌï¥Î≥¥ÏÑ∏Ïöî!', 'Î∂àÌïÑÏöîÌïú ÏßÄÏ∂úÏùÑ Ï§ÑÏù¥Îäî Í≤ÉÏù¥ Ï§ëÏöîÌï©ÎãàÎã§!'],
                    50: ['ÌÅ∞ ÏßÄÏ∂úÏùÄ ÌîºÌïòÍ≥† ÌòÑÏÉÅ Ïú†ÏßÄÏóê ÏßëÏ§ëÌïòÏÑ∏Ïöî!', 'Ï∂©ÎèôÍµ¨Îß§Î•º ÏûêÏ†úÌïòÍ≥† Ïã†Ï§ëÌïòÍ≤å ÏÜåÎπÑÌïòÏÑ∏Ïöî!'],
                    40: ['Îèà Î¨∏Ï†úÎ°ú Ïä§Ìä∏Î†àÏä§Î∞õÏßÄ ÏïäÎèÑÎ°ù Ï£ºÏùòÌïòÏÑ∏Ïöî!', 'ÎåÄÏ∂úÏù¥ÎÇò Ìà¨ÏûêÎäî Ïã†Ï§ëÌïòÍ≤å Í≤∞Ï†ïÌïòÏÑ∏Ïöî!'],
                    30: ['Ïò§ÎäòÏùÄ ÏßÄÍ∞ëÏùÑ Îã®Îã®Ìûà Îã´ÏïÑÎëêÏÑ∏Ïöî!', 'Í∏àÏ†Ñ Í±∞ÎûòÎäî ÏµúÎåÄÌïú ÌîºÌïòÎäî Í≤ÉÏù¥ Ï¢ãÍ≤†ÏäµÎãàÎã§!']
                }
            }
        };

        const LUCKY_ITEMS = {
            items: ['Î∞òÏßÄ', 'Î™©Í±∏Ïù¥', 'ÏãúÍ≥Ñ', 'Ìñ•Ïàò', 'Î¶ΩÎ∞§', 'Ï∞®ÌÇ§', 'ÏßÄÍ∞ë', 'Ïä§ÎßàÌä∏Ìè∞ ÏºÄÏù¥Ïä§'],
            colors: ['Îπ®Í∞ï', 'ÌååÎûë', 'ÎÖ∏Îûë', 'Ï¥àÎ°ù', 'Î≥¥Îùº', 'Î∂ÑÌôç', 'ÌïòÎäòÏÉâ', 'Ï£ºÌô©'],
            numbers: ['3', '7', '9', '12', '21', '27', '33', '42'],
            directions: ['ÎèôÏ™Ω', 'ÏÑúÏ™Ω', 'ÎÇ®Ï™Ω', 'Î∂ÅÏ™Ω', 'ÎèôÎÇ®Ï™Ω', 'ÎèôÎ∂ÅÏ™Ω', 'ÏÑúÎÇ®Ï™Ω', 'ÏÑúÎ∂ÅÏ™Ω']
        };

        // ===========================================
        // Ïö¥ÏÑ∏ Í≥ÑÏÇ∞
        // ===========================================
        function calcEnhancedDailyFortune(birthdate) {
            const today = new Date();
            const dateStr = `${today.getFullYear()}-${today.getMonth() + 1}-${today.getDate()}`;
            const results = {};

            Object.keys(FORTUNE_CATEGORIES).forEach((category, index) => {
                const seed = (birthdate || '').replaceAll('-', '') + dateStr + category + index;
                let hash = 0;
                for (let i = 0; i < seed.length; i++) {
                    hash = (hash * 37 + seed.charCodeAt(i)) % 100000;
                }
                const score = Math.abs(hash) % 100;

                let messageKey = 30;
                if (score >= 85) messageKey = 90;
                else if (score >= 75) messageKey = 80;
                else if (score >= 65) messageKey = 70;
                else if (score >= 55) messageKey = 60;
                else if (score >= 45) messageKey = 50;
                else if (score >= 35) messageKey = 40;

                const messages = FORTUNE_CATEGORIES[category].messages[messageKey];
                const messageIndex = Math.abs(hash) % messages.length;

                results[category] = {
                    name: FORTUNE_CATEGORIES[category].name,
                    icon: FORTUNE_CATEGORIES[category].icon,
                    score: score,
                    message: messages[messageIndex]
                };
            });

            // Îü≠ÌÇ§ ÏïÑÏù¥ÌÖú ÏÉùÏÑ±
            const luckyHash = birthdate.replaceAll('-', '') + dateStr + 'lucky';
            let lHash = 0;
            for (let i = 0; i < luckyHash.length; i++) {
                lHash = (lHash * 41 + luckyHash.charCodeAt(i)) % 100000;
            }

            return {
                categories: results,
                lucky: {
                    item: LUCKY_ITEMS.items[Math.abs(lHash) % LUCKY_ITEMS.items.length],
                    color: LUCKY_ITEMS.colors[Math.abs(lHash + 1) % LUCKY_ITEMS.colors.length],
                    number: LUCKY_ITEMS.numbers[Math.abs(lHash + 2) % LUCKY_ITEMS.numbers.length],
                    direction: LUCKY_ITEMS.directions[Math.abs(lHash + 3) % LUCKY_ITEMS.directions.length]
                },
                date: dateStr
            };
        }

        // ===========================================
        // Í≤∞Í≥º Î†åÎçîÎßÅ
        // ===========================================
        function createResultCard(icon, title, value, description, isMain = false, cardType = '') {
            let cardClass = 'result-card';
            if (isMain) cardClass += ' main-result';
            if (cardType) cardClass += ' ' + cardType;

            return `
            <div class="${cardClass}">
                <div class="card-header">
                    <div class="card-icon">${icon}</div>
                    <div class="card-title">${title}</div>
                </div>
                <div class="card-value">${value}</div>
                <div class="card-description">${description}</div>
            </div>
            `;
        }

        function renderEnhancedDailyFortune(fortuneData, name = '') {
            const nameTitle = name ? `<b>${name}</b>ÎãòÏùò ` : '';

            let html = `
            <div class="result-section">
                <div class="section-title-result">üåü ${nameTitle}Ïò§ÎäòÏùò Ïö¥ÏÑ∏</div>
                <div class="fortune-date">üìÖ ${fortuneData.date}</div>
            </div>
            `;

            // Í∞Å Ïπ¥ÌÖåÍ≥†Î¶¨Î≥Ñ Ïö¥ÏÑ∏ Ïπ¥Îìú
            html += '<div class="result-section">';
            Object.values(fortuneData.categories).forEach((category, index) => {
                const isMainCard = index === 0;
                html += createResultCard(
                    category.icon,
                    category.name,
                    `${category.score}Ï†ê`,
                    category.message,
                    isMainCard,
                    'fortune-card'
                );
            });
            html += '</div>';

            // Îü≠ÌÇ§ Ï†ïÎ≥¥ ÏÑπÏÖò
            html += `
            <div class="result-section">
                <div class="section-title-result">üçÄ Ïò§ÎäòÏùò Îü≠ÌÇ§ ÏïÑÏù¥ÌÖú</div>
                <div class="lucky-items-grid">
                    <div class="lucky-item-card">
                        <div class="lucky-icon">üéÅ</div>
                        <div class="lucky-label">Îü≠ÌÇ§ ÏïÑÏù¥ÌÖú</div>
                        <div class="lucky-value">${fortuneData.lucky.item}</div>
                    </div>
                    <div class="lucky-item-card">
                        <div class="lucky-icon">üé®</div>
                        <div class="lucky-label">Îü≠ÌÇ§ Ïª¨Îü¨</div>
                        <div class="lucky-value">${fortuneData.lucky.color}</div>
                    </div>
                    <div class="lucky-item-card">
                        <div class="lucky-icon">üî¢</div>
                        <div class="lucky-label">Îü≠ÌÇ§ ÎÑòÎ≤Ñ</div>
                        <div class="lucky-value">${fortuneData.lucky.number}</div>
                    </div>
                    <div class="lucky-item-card">
                        <div class="lucky-icon">üß≠</div>
                        <div class="lucky-label">Îü≠ÌÇ§ Î∞©Ìñ•</div>
                        <div class="lucky-value">${fortuneData.lucky.direction}</div>
                    </div>
                </div>
            </div>
            `;

            return html;
        }

        // ===========================================
        // Î°úÎòê Î≤àÌò∏ ÏÉùÏÑ±
        // ===========================================
        function generateLottoNumbers(birthStr = '') {
            const today = new Date();
            const weekKey = getISOWeek(today);
            const seed = weekKey + (birthStr || '');
            
            let hash = 0;
            for (let i = 0; i < seed.length; i++) {
                hash = (hash * 31 + seed.charCodeAt(i)) & 0x7fffffff;
            }
            
            const rng = seededRandom(hash);
            const numbers = [];
            
            while (numbers.length < 6) {
                const num = Math.floor(rng() * 45) + 1;
                if (!numbers.includes(num)) {
                    numbers.push(num);
                }
            }
            
            const bonus = Math.floor(rng() * 45) + 1;
            
            return {
                main: numbers.sort((a, b) => a - b),
                bonus: bonus,
                seedInfo: `Ï£º ${weekKey}${birthStr ? ` ¬∑ ${birthStr}` : ''}`
            };
        }

        function seededRandom(seed) {
            let state = seed;
            return function() {
                state = (state * 1664525 + 1013904223) >>> 0;
                return state / 0xFFFFFFFF;
            };
        }

        function getISOWeek(date) {
            const target = new Date(date.valueOf());
            const dayNr = (date.getDay() + 6) % 7;
            target.setDate(target.getDate() - dayNr + 3);
            const firstThursday = target.valueOf();
            target.setMonth(0, 1);
            if (target.getDay() !== 4) {
                target.setMonth(0, 1 + ((4 - target.getDay()) + 7) % 7);
            }
            return 1 + Math.ceil((firstThursday - target) / 604800000);
        }

        function renderLottoResult(result) {
            if (!result || !Array.isArray(result.main)) {
                return `
                <div class="info-box">
                    <div class="info-title">‚ÑπÔ∏è ÏïàÎÇ¥</div>
                    <div class="info-content">Î≤àÌò∏ ÏÉùÏÑ±Ïóê Ïã§Ìå®ÌñàÏñ¥Ïöî. Îã§Ïãú ÏãúÎèÑÌï¥ Ï£ºÏÑ∏Ïöî.</div>
                </div>`;
            }

            const ballsHtml = result.main
                .map(n => `<div class="ball">${String(n).padStart(2, '0')}</div>`)
                .join('');

            const bonusHtml = result.bonus ? 
                `<div style="align-self:center;font-weight:800;margin:0 4px">+</div>
                 <div class="ball bonus">${String(result.bonus).padStart(2, '0')}</div>` : '';

            return `
            <div class="result-section lotto-wrap">
                <div class="section-title-result">üé± ÌñâÏö¥Î≤àÌò∏</div>
                <div class="lotto-balls">
                    ${ballsHtml}
                    ${bonusHtml}
                </div>
                <div class="lotto-meta">ÏÉùÏÑ± Í∏∞Ï§Ä: ${result.seedInfo || 'ÎûúÎç§'} ¬∑ Ï∞∏Í≥†Ïö©</div>
            </div>
            <div class="info-box">
                <div class="info-title">‚ÑπÔ∏è ÏïàÎÇ¥</div>
                <div class="info-content">
                    ‚Ä¢ Í≤∞Í≥ºÎäî <strong>Í∞ôÏùÄ Ï£º(ISO Ï£º)</strong>ÏóêÎäî ÎèôÏùºÌï©ÎãàÎã§.<br/>
                    ‚Ä¢ ÏûÖÎ†•Ìïú ÏÉùÎÖÑÏõîÏùºÏù¥ Í∞ôÏúºÎ©¥ Í∞ôÏùÄ Ï£ºÏóêÎäî Í∞ôÏùÄ Ï∂îÏ≤úÏù¥ ÎÇòÏòµÎãàÎã§.<br/>
                    ‚Ä¢ Ïû¨ÎØ∏/Ï∞∏Í≥†Ïö©Ïù¥Î©∞, Ï±ÖÏûÑÏûàÎäî Íµ¨Îß§Î•º Í∂åÏû•Ìï¥Ïöî. üéØ
                </div>
            </div>
            `;
        }

        // ===========================================
        // ÌÉÄÎ°ú Í¥ÄÎ†®
        // ===========================================
        const TAROT_DETAILS = [
            {name: "THE FOOL (Î∞îÎ≥¥)", meaning: "ÏÉàÎ°úÏö¥ ÏãúÏûëÍ≥º ÏàúÏàòÌï®ÏùÑ ÎÇòÌÉÄÎÇ¥Îäî Ïπ¥ÎìúÏûÖÎãàÎã§.", upright: "ÏÉàÎ°úÏö¥ ÏãúÏûë, ÏàúÏßÑÌï®, ÏûêÎ∞úÏÑ±", reversed: "Î¨¥Î™®Ìï®, Í≤ΩÏÜîÌï®, ÏúÑÌóòÌïú ÌñâÎèô"},
            {name: "THE MAGICIAN (ÎßàÎ≤ïÏÇ¨)", meaning: "ÏùòÏßÄÎ†•Í≥º Ï∞ΩÏ°∞Î†•ÏùÑ ÎÇòÌÉÄÎÇ¥Îäî Ïπ¥ÎìúÏûÖÎãàÎã§.", upright: "ÏùòÏßÄÎ†•, Ï∞ΩÏ°∞Î†•, ÏßëÏ§ë", reversed: "Í∏∞Îßå, Ï°∞Ïûë, Îä•Î†• Î∂ÄÏ°±"},
            {name: "THE HIGH PRIESTESS (Ïó¨ÍµêÌô©)", meaning: "ÏßÅÍ∞êÍ≥º ÎÇ¥Î©¥Ïùò ÏßÄÌòúÎ•º ÎÇòÌÉÄÎÇ¥Îäî Ïπ¥ÎìúÏûÖÎãàÎã§.", upright: "ÏßÅÍ∞ê, Î¨¥ÏùòÏãù, Ïã†ÎπÑ", reversed: "ÎπÑÎ∞Ä, Ïà®Í≤®ÏßÑ ÎèôÍ∏∞, ÏßÅÍ∞ê Î¨¥Ïãú"},
            {name: "THE EMPRESS (Ïó¨Ìô©Ï†ú)", meaning: "ÌíçÏöîÏôÄ Î™®ÏÑ±ÏùÑ ÎÇòÌÉÄÎÇ¥Îäî Ïπ¥ÎìúÏûÖÎãàÎã§.", upright: "ÌíçÏöî, Î™®ÏÑ±, Ï∞ΩÏ°∞ÏÑ±", reversed: "Î∂àÏûÑ, Ï∞ΩÏ°∞ÏÑ± Î∂ÄÏ°±, Í≥ºÎ≥¥Ìò∏"},
            {name: "THE EMPEROR (Ìô©Ï†ú)", meaning: "Í∂åÏúÑÏôÄ ÏïàÏ†ïÏùÑ ÎÇòÌÉÄÎÇ¥Îäî Ïπ¥ÎìúÏûÖÎãàÎã§.", upright: "Í∂åÏúÑ, Íµ¨Ï°∞, ÏßàÏÑú", reversed: "ÎèÖÏû¨, Í∂åÏúÑÏ£ºÏùò, Í≤ΩÏßÅÏÑ±"},
            {name: "THE HIEROPHANT (ÍµêÌô©)", meaning: "Ï†ÑÌÜµÍ≥º ÍµêÏú°ÏùÑ ÎÇòÌÉÄÎÇ¥Îäî Ïπ¥ÎìúÏûÖÎãàÎã§.", upright: "Ï†ÑÌÜµ, ÍµêÏú°, Ï¢ÖÍµê", reversed: "Î∞òÌï≠, ÎπÑÏ†ïÌÜµÏÑ±, ÏÉàÎ°úÏö¥ Ï†ëÍ∑ºÎ≤ï"},
            {name: "THE LOVERS (Ïó∞Ïù∏)", meaning: "ÏÇ¨ÎûëÍ≥º ÏÑ†ÌÉùÏùÑ ÎÇòÌÉÄÎÇ¥Îäî Ïπ¥ÎìúÏûÖÎãàÎã§.", upright: "ÏÇ¨Îûë, Í¥ÄÍ≥Ñ, ÏÑ†ÌÉù", reversed: "Î∂àÍ∑†Ìòï, Í∞àÎì±, ÏûòÎ™ªÎêú ÏÑ†ÌÉù"},
            {name: "THE CHARIOT (Ï†ÑÏ∞®)", meaning: "ÏäπÎ¶¨ÏôÄ ÏùòÏßÄÎ•º ÎÇòÌÉÄÎÇ¥Îäî Ïπ¥ÎìúÏûÖÎãàÎã§.", upright: "ÏäπÎ¶¨, ÏùòÏßÄÎ†•, ÏûêÏ†úÎ†•", reversed: "ÌÜµÏ†úÎ†• ÏÉÅÏã§, Î∞©Ìñ•ÏÑ± Î∂ÄÏ°±"},
            {name: "STRENGTH (Ìûò)", meaning: "ÎÇ¥Ï†Å ÌûòÍ≥º Ïö©Í∏∞Î•º ÎÇòÌÉÄÎÇ¥Îäî Ïπ¥ÎìúÏûÖÎãàÎã§.", upright: "ÎÇ¥Ï†Å Ìûò, Ïö©Í∏∞, Ïù∏ÎÇ¥", reversed: "ÏïΩÌï®, ÏûêÍ∏∞ ÏùòÏã¨, ÏóêÎÑàÏßÄ Î∂ÄÏ°±"},
            {name: "THE HERMIT (ÏùÄÎëîÏûê)", meaning: "ÎÇ¥Ï†Å ÌÉêÍµ¨ÏôÄ ÏßÄÌòúÎ•º ÎÇòÌÉÄÎÇ¥Îäî Ïπ¥ÎìúÏûÖÎãàÎã§.", upright: "ÎÇ¥Ï†Å ÌÉêÍµ¨, ÏßÄÌòú, ÏÑ±Ï∞∞", reversed: "Í≥†Î¶Ω, Ïô∏Î°úÏõÄ, ÏûòÎ™ªÎêú Ï°∞Ïñ∏"},
            {name: "WHEEL OF FORTUNE (Ïö¥Î™ÖÏùò Î∞îÌÄ¥)", meaning: "Î≥ÄÌôîÏôÄ Ïö¥Î™ÖÏùÑ ÎÇòÌÉÄÎÇ¥Îäî Ïπ¥ÎìúÏûÖÎãàÎã§.", upright: "Î≥ÄÌôî, Ïö¥Î™Ö, Í∏∞Ìöå", reversed: "Î∂àÏö¥, ÌÜµÏ†úÎ†• ÏÉÅÏã§, Ïô∏Î∂Ä ÏòÅÌñ•"},
            {name: "JUSTICE (Ï†ïÏùò)", meaning: "Í≥µÏ†ïÍ≥º Í∑†ÌòïÏùÑ ÎÇòÌÉÄÎÇ¥Îäî Ïπ¥ÎìúÏûÖÎãàÎã§.", upright: "Ï†ïÏùò, Í≥µÏ†ïÏÑ±, ÏßÑÏã§", reversed: "Î∂àÍ≥µÏ†ï, Ìé∏Í≤¨, Ï±ÖÏûÑ ÌöåÌîº"},
            {name: "THE HANGED MAN (Îß§Îã¨Î¶∞ ÎÇ®Ïûê)", meaning: "Ìù¨ÏÉùÍ≥º Í¥ÄÏ†êÏùò Ï†ÑÌôòÏùÑ ÎÇòÌÉÄÎÇ¥Îäî Ïπ¥ÎìúÏûÖÎãàÎã§.", upright: "Ìù¨ÏÉù, Í¥ÄÏ†ê Ï†ÑÌôò, Í∏∞Îã§Î¶º", reversed: "Î∂àÌïÑÏöîÌïú Ìù¨ÏÉù, ÏßÄÏó∞, Ï†ÄÌï≠"},
            {name: "DEATH (Ï£ΩÏùå)", meaning: "Î≥ÄÌôîÏôÄ Ïû¨ÏÉùÏùÑ ÎÇòÌÉÄÎÇ¥Îäî Ïπ¥ÎìúÏûÖÎãàÎã§.", upright: "Î≥ÄÌôî, ÎÅùÍ≥º ÏãúÏûë, Ïû¨ÏÉù", reversed: "Î≥ÄÌôîÏóê ÎåÄÌïú Ï†ÄÌï≠, Ï†ïÏ≤¥"},
            {name: "TEMPERANCE (Ï†àÏ†ú)", meaning: "Í∑†ÌòïÍ≥º Ï°∞ÌôîÎ•º ÎÇòÌÉÄÎÇ¥Îäî Ïπ¥ÎìúÏûÖÎãàÎã§.", upright: "Í∑†Ìòï, Ï†àÏ†ú, Ï°∞Ìôî", reversed: "Î∂àÍ∑†Ìòï, Í≥ºÎèÑÌï®, Ï°∞Í∏âÌï®"},
            {name: "THE DEVIL (ÏïÖÎßà)", meaning: "Ïú†ÌòπÍ≥º ÏÜçÎ∞ïÏùÑ ÎÇòÌÉÄÎÇ¥Îäî Ïπ¥ÎìúÏûÖÎãàÎã§.", upright: "Ïú†Ìòπ, ÏÜçÎ∞ï, Ï§ëÎèÖ", reversed: "Ìï¥Î∞©, ÏûêÏú†, ÏÜçÎ∞ïÏóêÏÑú Î≤óÏñ¥ÎÇ®"},
            {name: "THE TOWER (ÌÉë)", meaning: "ÌååÍ¥¥ÏôÄ Í∏âÎ≥ÄÏùÑ ÎÇòÌÉÄÎÇ¥Îäî Ïπ¥ÎìúÏûÖÎãàÎã§.", upright: "ÌååÍ¥¥, Í∏âÎ≥Ä, Í≥ÑÏãú", reversed: "ÎÇ¥Ï†Å Î≥ÄÌôî, Í∞úÏù∏Ï†Å Î≥ÄÌôî"},
            {name: "THE STAR (Î≥Ñ)", meaning: "Ìù¨ÎßùÍ≥º ÏòÅÍ∞êÏùÑ ÎÇòÌÉÄÎÇ¥Îäî Ïπ¥ÎìúÏûÖÎãàÎã§.", upright: "Ìù¨Îßù, ÏòÅÍ∞ê, ÏπòÏú†", reversed: "Ï†àÎßù, Ìù¨Îßù ÏÉÅÏã§, Î∞©Ìñ•ÏÑ± Î∂ÄÏ°±"},
            {name: "THE MOON (Îã¨)", meaning: "ÌôòÏÉÅÍ≥º Î∂àÏïàÏùÑ ÎÇòÌÉÄÎÇ¥Îäî Ïπ¥ÎìúÏûÖÎãàÎã§.", upright: "ÌôòÏÉÅ, Î∂àÏïà, ÌòºÎûÄ", reversed: "ÏßÑÏã§ ÎìúÎü¨ÎÇ®, Î™ÖÌôïÏÑ±"},
            {name: "THE SUN (ÌÉúÏñë)", meaning: "Í∏∞ÏÅ®Í≥º ÏÑ±Í≥µÏùÑ ÎÇòÌÉÄÎÇ¥Îäî Ïπ¥ÎìúÏûÖÎãàÎã§.", upright: "Í∏∞ÏÅ®, ÏÑ±Í≥µ, ÌôúÎ†•", reversed: "ÏùºÏãúÏ†Å Í∏∞ÏÅ®, ÏóêÎÑàÏßÄ Î∂ÄÏ°±"},
            {name: "JUDGEMENT (Ïã¨Ìåê)", meaning: "Î∂ÄÌôúÍ≥º Í∞ÅÏÑ±ÏùÑ ÎÇòÌÉÄÎÇ¥Îäî Ïπ¥ÎìúÏûÖÎãàÎã§.", upright: "Î∂ÄÌôú, Í∞ÅÏÑ±, ÏÉàÎ°úÏö¥ ÏãúÏûë", reversed: "ÏûêÍ∏∞ ÏùòÏã¨, Í≥ºÍ±∞Ïóê ÏñΩÎß§ÏûÑ"},
            {name: "THE WORLD (ÏÑ∏Í≥Ñ)", meaning: "ÏôÑÏÑ±Í≥º ÏÑ±Ï∑®Î•º ÎÇòÌÉÄÎÇ¥Îäî Ïπ¥ÎìúÏûÖÎãàÎã§.", upright: "ÏôÑÏÑ±, ÏÑ±Ï∑®, ÌÜµÌï©", reversed: "ÎØ∏ÏôÑÏÑ±, Î™©Ìëú Î∂ÄÏ°±, ÏßÄÏó∞"}
        ];

        const CARD_ICONS = ["üÉè", "üé©", "üîÆ", "üëë", "‚ö°", "‚õ™", "üíï", "üèÜ", "üí™", "üïØÔ∏è", "üé∞", "‚öñÔ∏è", "üôÉ", "üíÄ", "‚öñÔ∏è", "üòà", "üóº", "‚≠ê", "üåô", "‚òÄÔ∏è", "üìØ", "üåç"];

        function initializeTarot() {
            const tarotCards = $$('.tarot-card-back');
            
            tarotCards.forEach(card => {
                if (card.__bound) return;
                card.addEventListener('click', () => selectTarotCard(card));
                card.__bound = true;
            });

            const randomBtn = $('#btnRandomTarot');
            if (randomBtn && !randomBtn.__bound) {
                randomBtn.addEventListener('click', drawRandomTarotCard);
                randomBtn.__bound = true;
            }

            const resetBtn = $('#btnResetTarot');
            if (resetBtn && !resetBtn.__bound) {
                resetBtn.addEventListener('click', resetTarotCards);
                resetBtn.__bound = true;
            }

            resetTarotCards();
        }

        function selectTarotCard(cardElement) {
            if (cardElement.classList.contains('revealed')) return;

            const randomTarotIndex = Math.floor(Math.random() * TAROT_DETAILS.length);
            const isUpright = Math.random() < 0.7;
            const selectedCard = TAROT_DETAILS[randomTarotIndex];

            if (!selectedCard) return;

            cardElement.classList.add('flipped');
            
            setTimeout(() => {
                const frontElement = document.createElement('div');
                frontElement.className = 'tarot-card-front';
                frontElement.innerHTML = `
                <div class="card-number">${randomTarotIndex}</div>
                <div class="card-icon">${CARD_ICONS[randomTarotIndex]}</div>
                <div class="card-name">${selectedCard.name.split('(')[0].trim()}</div>
                <div class="card-direction">${isUpright ? 'Ï†ïÏúÑ' : 'Ïó≠ÏúÑ'}</div>
                `;
                cardElement.appendChild(frontElement);
                cardElement.classList.add('revealed');
                setTimeout(() => frontElement.style.opacity = '1', 100);
            }, 300);

            setTimeout(() => showTarotModal(randomTarotIndex, isUpright), 800);
            
            pushRecent({
                type: 'tarot',
                card: selectedCard.name,
                upright: isUpright,
                meaning: isUpright ? selectedCard.upright : selectedCard.reversed
            });
            
            reactCrystal(`${selectedCard.name.split('(')[0].trim()}ÏùÑ ÎΩëÏïòÏäµÎãàÎã§! ‚ú®`);
        }

        function showTarotModal(cardIndex, isUpright) {
            const modal = $('#tarotModalOverlay');
            const content = $('#tarotModalContent');
            if (!modal || !content) return;

            const card = TAROT_DETAILS[cardIndex];
            if (!card) return;

            content.innerHTML = `
            <h2>${card.name}</h2>
            <p style="color:#6B7280; margin-bottom:20px; line-height:1.6; font-style:italic;">${card.meaning}</p>
            <div class="meaning-section upright"><h3>‚¨ÜÔ∏è Ï†ïÎ∞©Ìñ• ÏùòÎØ∏</h3><p>${card.upright}</p></div>
            <br>
            <div class="meaning-section reversed"><h3>‚¨áÔ∏è Ïó≠Î∞©Ìñ• ÏùòÎØ∏</h3><p>${card.reversed}</p></div>
            <div style="margin-top:25px; padding:15px; background:rgba(255,215,0,0.1); border-radius:10px; border-left:4px solid #ffd700;">
                <h3 style="color:#ffd700; margin-bottom:10px;">${isUpright ? '‚¨ÜÔ∏è ÌòÑÏû¨ ÎΩëÌûå Î∞©Ìñ•: Ï†ïÎ∞©Ìñ•' : '‚¨áÔ∏è ÌòÑÏû¨ ÎΩëÌûå Î∞©Ìñ•: Ïó≠Î∞©Ìñ•'}</h3>
                <p style="color:#333; line-height:1.5;">${isUpright ? card.upright : card.reversed}</p>
            </div>
            `;
            
            modal.style.display = 'flex';
            requestAnimationFrame(() => modal.classList.add('show'));
        }

        function closeTarotModal() {
            const modal = $('#tarotModalOverlay');
            if (!modal) return;
            modal.classList.remove('show');
            modal.style.display = 'none';
        }

        function resetTarotCards() {
            $$('.tarot-card-back').forEach(card => {
                card.classList.remove('flipped', 'revealed');
                card.style.transform = '';
                card.querySelector('.tarot-card-front')?.remove();
            });
            closeTarotModal();
            reactCrystal('ÏÉàÎ°úÏö¥ Ïπ¥ÎìúÎì§Ïù¥ Ï§ÄÎπÑÎêòÏóàÏäµÎãàÎã§ ‚ú®');
        }

        function drawRandomTarotCard() {
            const available = $$('.tarot-card-back:not(.revealed)');
            if (!available.length) {
                reactCrystal('Î™®Îì† Ïπ¥ÎìúÎ•º Ïù¥ÎØ∏ ÎΩëÏïòÏäµÎãàÎã§! üîÑ');
                return;
            }
            const el = available[Math.floor(Math.random() * available.length)];
            setTimeout(() => selectTarotCard(el), 300);
        }

        // ===========================================
        // Ïù¥Î≤§Ìä∏ Î¶¨Ïä§ÎÑà
        // ===========================================
        function bindEventListeners() {
            console.log('üîó Ïù¥Î≤§Ìä∏ Î¶¨Ïä§ÎÑà Î∞îÏù∏Îî© ÏãúÏûë...');

            // Ïò§ÎäòÏùò Ïö¥ÏÑ∏ Î≤ÑÌäº
            $('#btnToday')?.addEventListener('click', () => {
                const birthRaw = $('#today-birth')?.value || '';
                const name = $('#today-name')?.value?.trim() || '';

                try {
                    if (!birthRaw.trim()) {
                        alert('ÏÉùÎÖÑÏõîÏùºÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî.');
                        return;
                    }

                    const fortuneData = calcEnhancedDailyFortune(birthRaw);
                    const htmlResult = renderEnhancedDailyFortune(fortuneData, name);

                    openSheet('Ïò§ÎäòÏùò Ïö¥ÏÑ∏', htmlResult, {
                        type: 'enhanced-today',
                        birth_input: birthRaw,
                        name: name,
                        data: fortuneData
                    });

                    reactCrystal('Ïò§ÎäòÏùò ÏÉÅÏÑ∏ Ïö¥ÏÑ∏Î•º Î∂àÎü¨ÏôîÏäµÎãàÎã§! ‚ú®');
                } catch (e) {
                    console.error(e);
                    alert(e.message || 'ÏûÖÎ†• Í∞íÏùÑ ÌôïÏù∏Ìï¥ Ï£ºÏÑ∏Ïöî.');
                }
            });

            // Î°úÎòê Î≤àÌò∏ Î≤ÑÌäº
            $('#btnLotto')?.addEventListener('click', () => {
                const birth = $('#lotto-birth')?.value?.trim() || '';
                try {
                    const result = generateLottoNumbers(birth);
                    const html = renderLottoResult(result);
                    
                    openSheet('üé± ÌñâÏö¥Ïùò Î°úÎòêÎ≤àÌò∏', html, {
                        type: 'lotto',
                        birth,
                        result
                    });
                    
                    reactCrystal('Ïù¥Î≤à Ï£º ÌñâÏö¥Î≤àÌò∏Î•º ÎΩëÏïòÏñ¥Ïöî! ‚ú®');
                } catch (e) {
                    console.error(e);
                    alert('ÌñâÏö¥Î≤àÌò∏ ÏÉùÏÑ± Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.');
                }
            });

            // ÏãúÌä∏ Îã´Í∏∞ Î≤ÑÌäº
            $('#btnClose')?.addEventListener('click', closeSheet);
            
            // ÏãúÌä∏ Î∞∞Í≤Ω ÌÅ¥Î¶≠Ïãú Îã´Í∏∞
            sheet?.addEventListener('click', e => {
                if (e.target === sheet) closeSheet();
            });

            // Í≤∞Í≥º Ï†ÄÏû• Î≤ÑÌäº
            $('#btnSave')?.addEventListener('click', () => {
                if (!lastResult) {
                    closeSheet();
                    return;
                }
                pushRecent(lastResult);
                
                const notice = document.createElement('div');
                notice.textContent = 'üìÅ ÏµúÍ∑º Í≤∞Í≥ºÏóê Ï†ÄÏû•ÎêêÏäµÎãàÎã§.';
                notice.style.cssText = 'margin-top:16px;padding:12px;background:rgba(102,126,234,0.1);border-radius:8px;text-align:center;color:#667eea;font-weight:bold;';
                sheetContent?.appendChild(notice);
                setTimeout(() => notice.remove(), 3000);
            });

            // ÎÑ§ÎπÑÍ≤åÏù¥ÏÖò ÌÅ¥Î¶≠
            $$('.nav-item[data-tab]').forEach(item => {
                item.addEventListener('click', () => {
                    const tab = item.dataset.tab || 'home';
                    location.hash = '#/' + tab;
                    reactCrystal(`${tab} ÌéòÏù¥ÏßÄÎ°ú Ïù¥ÎèôÌï©ÎãàÎã§! ‚ú®`);
                });
            });

            // ÏÑúÎπÑÏä§ Ïπ¥Îìú ÌÅ¥Î¶≠
            $$('.service-item, .special-item').forEach(card => {
                card.addEventListener('click', () => {
                    const route = card.dataset.route || 'fortune-today';
                    if (route.startsWith('fortune-')) {
                        location.hash = '#/fortune/' + route.replace('fortune-', '');
                    }
                });
            });

            // ÌÅ¨Î¶¨Ïä§ÌÉà ÌÅ¥Î¶≠
            $('#mainCrystal')?.addEventListener('click', () => {
                reactCrystal('üîÆ Ïã†ÎπÑÎ°úÏö¥ ÌûòÏùÑ ÎäêÍª¥Î≥¥ÏÑ∏Ïöî');
            });

            // ÌÉÄÎ°ú Î™®Îã¨ Îã´Í∏∞
            $('#tarotCloseBtn')?.addEventListener('click', closeTarotModal);
            
            // ÌÉÄÎ°ú Î™®Îã¨ Î∞∞Í≤Ω ÌÅ¥Î¶≠
            $('#tarotModalOverlay')?.addEventListener('click', e => {
                if (e.target === $('#tarotModalOverlay')) closeTarotModal();
            });

            console.log('‚úÖ Ïù¥Î≤§Ìä∏ Î¶¨Ïä§ÎÑà Î∞îÏù∏Îî© ÏôÑÎ£å');
        }

        // ===========================================
        // Ï¥àÍ∏∞Ìôî
        // ===========================================
        function initMysticTell() {
            console.log('üöÄ MysticTell Ï¥àÍ∏∞Ìôî ÏãúÏûë...');

            // Ïù¥Î≤§Ìä∏ Î¶¨Ïä§ÎÑà Î∞îÏù∏Îî©
            bindEventListeners();

            // Ïä§ÌîåÎûòÏãú Ïà®Í∏∞Í∏∞
            hideSplash();

            // Ï¥àÍ∏∞ ÎùºÏö∞ÌåÖ
            if (!location.hash) {
                location.hash = '#/home';
            }
            routeFromHash();

            console.log('‚úÖ MysticTell Ï¥àÍ∏∞Ìôî ÏôÑÎ£å');
        }

        // ===========================================
        // Ï†ÑÏó≠ Ïù¥Î≤§Ìä∏
        // ===========================================

        // Ìï¥Ïãú Î≥ÄÍ≤Ω Ïãú ÎùºÏö∞ÌåÖ
        window.addEventListener('hashchange', routeFromHash);

        // ÌéòÏù¥ÏßÄ Î°úÎìú ÏôÑÎ£å Ïãú Ï¥àÍ∏∞Ìôî
        window.addEventListener('load', initMysticTell);

        // DOM Ï§ÄÎπÑ Ïãú Ïä§ÌîåÎûòÏãú Ï≤òÎ¶¨
        document.addEventListener('DOMContentLoaded', () => {
            const startBtn = $('#startBtn');
            startBtn?.addEventListener('click', (e) => {
                e.preventDefault();
                hideSplash();
            });

            // ÏûêÎèô Ïä§ÌîåÎûòÏãú Ïà®ÍπÄ (3Ï¥à ÌõÑ)
            setTimeout(hideSplash, 3000);
        });

        // ESC ÌÇ§Î°ú Î™®Îã¨ Îã´Í∏∞
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                closeAllOverlays();
            }
        });

        // ÏóêÎü¨ Ï≤òÎ¶¨
        window.addEventListener('error', (e) => {
            console.error('Global error:', e);
            closeSheet();
        });

        console.log('üì± MysticTell JavaScript Î°úÎìú ÏôÑÎ£å');
    </script>
</body>
</html>
