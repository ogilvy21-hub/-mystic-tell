<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ”® MysticTell - ë§ì¶¤ ìš´ì„¸</title>
    <meta name="description" content="ì‹ ë¹„ë¡œìš´ ë¯¸ë˜ë¥¼ ì•Œë ¤ë“œë¦¬ëŠ” ë””ì§€í„¸ ì ìˆ ì‚¬ - ì˜¤ëŠ˜ì˜ ìš´ì„¸, ì •í†µ ì‚¬ì£¼, íƒ€ë¡œ ì¹´ë“œ">
    <meta name="keywords" content="ìš´ì„¸, ì‚¬ì£¼, íƒ€ë¡œ, ì ìˆ , ë¯¸ìŠ¤í‹±í…”">
    
    <style>
        :root {
            --splash-bg-url: url('https://i.imgur.com/zjaoFlI.png');
            --start-img-url: url('https://i.imgur.com/SmhPkiD.png');
            --start-blink-duration: 1700ms;
            --start-blink-scale-min: 1;
            --start-blink-scale-max: 1.06;
            --start-blink-opacity-min: .85;
            --sheetW: 640px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Apple SD Gothic Neo', 'Malgun Gothic', sans-serif;
            background: #fff;
            min-height: 100vh;
            color: #333;
            overflow-x: hidden;
        }

        .container {
            max-width: 430px;
            margin: 0 auto;
            min-height: 100vh;
            position: relative;
        }

        /* ===== ìŠ¤í”Œë˜ì‹œ í™”ë©´ ===== */
        #splashScreen {
            position: fixed;
            inset: 0;
            z-index: 99999;
            display: flex;
            align-items: center;
            justify-content: center;
            background: center/cover no-repeat var(--splash-bg-url);
            touch-action: manipulation;
        }

        #splashScreen::after {
            content: "";
            position: absolute;
            inset: 0;
            background: linear-gradient(to bottom, rgba(0,0,0,.10), rgba(0,0,0,.18));
            pointer-events: none;
        }

        #splashScreen.hidden {
            opacity: 0;
            transform: scale(.98);
            pointer-events: none;
            transition: all .6s ease;
            display: none !important;
        }

        .start-image-btn {
            position: relative;
            z-index: 2;
            display: block;
            width: min(100%, 400px);
            aspect-ratio: 3.2 / 1;
            background: center/contain no-repeat var(--start-img-url);
            border: none;
            outline: none;
            cursor: pointer;
            -webkit-tap-highlight-color: transparent;
            filter: drop-shadow(0 10px 22px rgba(0,0,0,.35));
            transition: transform .08s ease, filter .12s ease;
            animation: start-blink var(--start-blink-duration) ease-in-out infinite;
            will-change: transform, opacity, filter;
        }

        .start-image-btn:active {
            transform: translateY(1px) scale(.99);
            filter: drop-shadow(0 6px 16px rgba(0,0,0,.35));
        }

        @keyframes start-blink {
            0%, 100% {
                opacity: var(--start-blink-opacity-min);
                transform: scale(var(--start-blink-scale-min));
                filter: drop-shadow(0 10px 22px rgba(0,0,0,.32));
            }
            50% {
                opacity: 1;
                transform: scale(var(--start-blink-scale-max));
                filter: drop-shadow(0 16px 28px rgba(0,0,0,.4));
            }
        }

        /* ===== ë©”ì¸ ì½˜í…ì¸  ===== */
        #mainContent {
            display: none;
            background: #fff;
            min-height: 100vh;
            padding: 20px;
            padding-bottom: 100px;
        }

        #mainContent.show {
            display: block;
            animation: slideIn .8s ease-out;
        }

        @keyframes slideIn {
            from { transform: translateY(100%); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            text-align: center;
            color: #fff;
            border-radius: 0 0 30px 30px;
            margin: -20px -20px 30px -20px;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,.1) 0%, transparent 70%);
            animation: sparkle 4s ease-in-out infinite;
        }

        @keyframes sparkle {
            0%, 100% { opacity: .3; transform: scale(1); }
            50% { opacity: .8; transform: scale(1.1); }
        }

        .logo {
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 8px;
            position: relative;
            z-index: 2;
        }

        .subtitle {
            font-size: 14px;
            opacity: .9;
            position: relative;
            z-index: 2;
        }

        #mainCrystal {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            margin: 20px auto;
            border: 3px solid rgba(102,126,234,.3);
            background: radial-gradient(circle at 30% 30%, rgba(255,255,255,.8), rgba(255,255,255,.3), transparent);
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            color: #eef;
            font-size: 14px;
            animation: float 3s ease-in-out infinite;
            cursor: pointer;
            transition: all .3s ease;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-8px); }
        }

        #mainCrystal:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 20px rgba(102,126,234,.3);
        }

        .section-title {
            font-size: 20px;
            font-weight: bold;
            margin: 30px 0 16px;
            color: #333;
            text-align: center;
        }

        /* ===== í˜ì´ì§€ ë° ë·° ê´€ë¦¬ ===== */
        .page {
            display: none;
        }

        .page.show {
            display: block;
        }

        /* ===== ì„œë¹„ìŠ¤ ê·¸ë¦¬ë“œ ===== */
        .service-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
            margin-bottom: 8px;
        }

        .service-item {
            background: linear-gradient(135deg, #ffefd5 0%, #ffd5e5 100%);
            border-radius: 16px;
            padding: 20px 12px;
            text-align: center;
            box-shadow: 0 6px 20px rgba(0,0,0,.08);
            transition: all .2s;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .service-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,.4), transparent);
            transition: left .5s;
        }

        .service-item:hover::before {
            left: 100%;
        }

        .service-item:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 24px rgba(0,0,0,.12);
        }

        .service-icon {
            font-size: 32px;
            margin-bottom: 8px;
            display: block;
        }

        .service-name {
            font-size: 16px;
            font-weight: bold;
            color: #333;
            margin-bottom: 6px;
        }

        .service-desc {
            font-size: 12px;
            color: #666;
            line-height: 1.4;
        }

        .special-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin: 16px 0 24px;
        }

        .special-item {
            background: linear-gradient(135deg, #e3f2fd 0%, #f3e5f5 100%);
            border-radius: 14px;
            padding: 16px;
            text-align: center;
            cursor: pointer;
            transition: all .2s;
        }

        .special-item:hover {
            transform: scale(1.02);
            box-shadow: 0 5px 15px rgba(0,0,0,.1);
        }

        .special-icon {
            font-size: 24px;
            margin-bottom: 8px;
        }

        .special-title {
            font-size: 14px;
            font-weight: bold;
            margin-bottom: 4px;
            color: #333;
        }

        .special-desc {
            font-size: 11px;
            color: #666;
        }

        /* ===== ì¹´ë“œ ìŠ¤íƒ€ì¼ ===== */
        .card {
            background: #fff;
            border: 1px solid #eee;
            border-radius: 14px;
            padding: 16px;
            box-shadow: 0 8px 24px rgba(0,0,0,.06);
            margin-bottom: 20px;
        }

        .field {
            display: flex;
            flex-direction: column;
            gap: 6px;
            margin-bottom: 12px;
        }

        .label {
            font-size: 13px;
            color: #444;
            font-weight: bold;
        }

        .input, select {
            padding: 12px;
            border-radius: 10px;
            border: 1px solid #ddd;
            font-size: 14px;
            background: #fff;
            outline: none;
        }

        .btn {
            display: inline-flex;
            justify-content: center;
            align-items: center;
            gap: 8px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: #fff;
            border: none;
            border-radius: 12px;
            padding: 12px 16px;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 6px 16px rgba(102,126,234,.25);
            transition: transform .1s ease;
            text-decoration: none;
        }

        .btn:active {
            transform: translateY(1px);
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 12px;
            cursor: pointer;
            font-weight: bold;
            margin: 8px;
        }

        .btn-ghost {
            background: #f6f6f6;
            color: #333;
            border: 1px solid #ddd;
        }

        /* ===== í•˜ë‹¨ ë„¤ë¹„ê²Œì´ì…˜ ===== */
        #bottomNav {
            position: fixed;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            max-width: 430px;
            width: 100%;
            background: #fff;
            padding: 10px 16px;
            box-shadow: 0 -2px 15px rgba(0,0,0,.1);
            display: none;
            justify-content: space-around;
            border-radius: 16px 16px 0 0;
            z-index: 20;
        }

        #bottomNav.show {
            display: flex;
        }

        .nav-item {
            text-align: center;
            cursor: pointer;
            transition: all .2s;
            padding: 8px;
            border-radius: 12px;
            user-select: none;
        }

        .nav-item:hover {
            background: #f5f5f5;
            transform: translateY(-2px);
        }

        .nav-icon {
            font-size: 20px;
            margin-bottom: 4px;
        }

        .nav-text {
            font-size: 11px;
            color: #666;
        }

        .nav-item.active .nav-text {
            color: #667eea;
            font-weight: bold;
        }

        .nav-item.active .nav-icon {
            color: #667eea;
        }

        /* ===== ê²°ê³¼ ì‹œíŠ¸ ===== */
        #sheetBackdrop {
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,.4);
            display: none;
            align-items: flex-end;
            justify-content: center;
            z-index: 30;
            backdrop-filter: blur(5px);
        }

        #sheetBackdrop.show {
            display: flex;
        }

        .sheet {
            width: 100%;
            max-width: 430px;
            background: #fff;
            border-radius: 20px 20px 0 0;
            max-height: 85vh;
            overflow-y: auto;
            animation: sheetUp .3s ease-out;
            box-shadow: 0 -10px 40px rgba(0,0,0,.2);
        }

        @keyframes sheetUp {
            from { transform: translateY(100%); }
            to { transform: translateY(0); }
        }

        .sheet-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 20px 20px 10px;
            border-bottom: 1px solid #f0f0f0;
            background: linear-gradient(135deg, #f8f9ff 0%, #fff 100%);
        }

        #sheetTitle {
            font-size: 20px;
            font-weight: 700;
            color: #333;
        }

        #btnClose {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            border: none;
            background: rgba(102,126,234,.1);
            color: #667eea;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all .2s ease;
        }

        #btnClose:hover {
            background: rgba(102,126,234,.2);
            transform: scale(1.1);
        }

        #sheetContent {
            padding: 20px;
            line-height: 1.6;
            color: #333;
        }

        .sheet-actions {
            padding: 0 20px 30px;
            display: flex;
            gap: 12px;
            justify-content: center;
        }

        /* ===== ê²°ê³¼ ì¹´ë“œ ===== */
        .result-card {
            background: linear-gradient(135deg, #fff 0%, #f8f9ff 100%);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 16px;
            box-shadow: 0 8px 24px rgba(0,0,0,0.08);
            border: 1px solid rgba(102, 126, 234, 0.1);
            position: relative;
            overflow: hidden;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .result-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 32px rgba(0,0,0,0.12);
        }

        .card-header {
            display: flex;
            align-items: center;
            margin-bottom: 12px;
        }

        .card-icon {
            font-size: 20px;
            margin-right: 12px;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }

        .card-title {
            font-size: 16px;
            font-weight: bold;
            color: #333;
        }

        .card-value {
            font-size: 20px;
            font-weight: 800;
            color: #667eea;
            margin: 8px 0;
        }

        .card-description {
            font-size: 14px;
            line-height: 1.6;
            color: #555;
        }

        .card-description strong {
            color: #667eea;
            font-weight: 700;
        }

        .section-title-result {
            font-size: 18px;
            font-weight: bold;
            color: #333;
            margin-bottom: 16px;
            padding-left: 12px;
            border-left: 4px solid #667eea;
        }

        .result-section {
            margin-bottom: 24px;
        }

        /* ===== ì •ë³´ ë°•ìŠ¤ ===== */
        .info-box {
            background: rgba(102, 126, 234, 0.05);
            border: 1px dashed rgba(102, 126, 234, 0.3);
            border-radius: 12px;
            padding: 16px;
            margin-top: 20px;
        }

        .info-title {
            font-size: 14px;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 8px;
        }

        .info-content {
            font-size: 13px;
            line-height: 1.5;
            color: #666;
        }

        /* ===== ë¡œë˜ ìŠ¤íƒ€ì¼ ===== */
        .lotto-wrap {
            text-align: center;
        }

        .lotto-balls {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
            margin: 10px 0 6px;
        }

        .ball {
            width: 44px;
            height: 44px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 800;
            color: #fff;
            background: linear-gradient(135deg, #667eea, #764ba2);
            box-shadow: 0 6px 16px rgba(0,0,0,.18);
        }

        .ball.bonus {
            background: linear-gradient(135deg, #ff9800, #ffc107);
        }

        .lotto-meta {
            color: #666;
            font-size: 12px;
            margin-top: 6px;
        }

        /* ===== íƒ€ë¡œ ì¹´ë“œ ===== */
        .tarot-card-selection {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 16px;
            padding: 20px 0;
        }

        .tarot-row {
            display: flex;
            justify-content: center;
            gap: 12px;
            flex-wrap: wrap;
        }

        .tarot-card-back {
            width: 70px;
            height: 105px;
            background: linear-gradient(145deg, #2c3e50 0%, #34495e 100%);
            border-radius: 12px;
            border: 3px solid #667eea;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            box-shadow: 0 8px 25px rgba(0,0,0,0.15), inset 0 1px 3px rgba(255,255,255,0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            transform-style: preserve-3d;
        }

        .tarot-card-back:hover {
            transform: translateY(-8px) scale(1.05);
            box-shadow: 0 15px 35px rgba(0,0,0,0.25), 0 0 20px rgba(102,126,234,0.4);
            border-color: #ffd700;
        }

        .card-back-design {
            font-size: 22px;
            color: #ffd700;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
            filter: drop-shadow(0 0 8px rgba(255,215,0,0.3));
            animation: twinkle 2s ease-in-out infinite;
        }

        @keyframes twinkle {
            0%, 100% { opacity: 0.7; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.1); }
        }

        .tarot-card-front {
            position: absolute;
            inset: 0;
            background: #fff;
            border-radius: 9px;
            padding: 6px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            font-size: 9px;
            color: #333;
            border: 2px solid #ffd700;
            box-shadow: inset 0 2px 8px rgba(255,215,0,0.2);
            transform: rotateY(180deg);
            backface-visibility: hidden;
            opacity: 0;
            transition: opacity 0.5s ease;
        }

        .tarot-card-back.revealed .tarot-card-front {
            opacity: 1;
        }

        .tarot-card-back.flipped {
            transform: rotateY(180deg);
        }

        .tarot-actions {
            margin-top: 20px;
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
        }

        /* ===== íƒ€ë¡œ ëª¨ë‹¬ ===== */
        #tarotModalOverlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.8);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 20px;
            backdrop-filter: blur(5px);
        }

        #tarotModalOverlay.show {
            display: flex;
        }

        .tarot-modal {
            background: linear-gradient(145deg, #2c3e50 0%, #34495e 100%);
            border-radius: 20px;
            padding: 30px;
            max-width: 500px;
            width: 100%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 25px 60px rgba(0,0,0,0.8), inset 0 2px 5px rgba(255,255,255,0.1);
            border: 2px solid #667eea;
            position: relative;
            color: white;
            animation: modalIn 0.3s ease-out;
        }

        @keyframes modalIn {
            from {
                opacity: 0;
                transform: scale(0.9) translateY(-20px);
            }
            to {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }

        #tarotCloseBtn {
            position: absolute;
            top: 15px;
            right: 20px;
            background: none;
            border: none;
            color: #ffd700;
            font-size: 24px;
            cursor: pointer;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
        }

        #tarotCloseBtn:hover {
            background: rgba(255,215,0,0.1);
            transform: scale(1.1);
        }

        /* ===== ëŸ­í‚¤ ì•„ì´í…œ ê·¸ë¦¬ë“œ ===== */
        .lucky-items-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .lucky-item-card {
            background: linear-gradient(135deg, #f8f9ff, #e8f4ff);
            border: 2px solid #e0e7ff;
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            transition: transform 0.2s ease;
        }

        .lucky-item-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.2);
        }

        .lucky-icon {
            font-size: 24px;
            margin-bottom: 8px;
        }

        .lucky-label {
            font-size: 12px;
            color: #666;
            margin-bottom: 5px;
        }

        .lucky-value {
            font-weight: bold;
            color: #333;
            font-size: 16px;
        }

        .fortune-date {
            text-align: center;
            color: #667eea;
            font-weight: bold;
            margin-bottom: 20px;
            font-size: 16px;
        }

        .spacer {
            height: 100px;
        }

        /* ===== ë°˜ì‘í˜• ===== */
        @media (max-width: 768px) {
            .service-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 12px;
            }
            
            .tarot-card-back {
                width: 60px;
                height: 90px;
            }
            
            .card-back-design {
                font-size: 18px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- ìŠ¤í”Œë˜ì‹œ í™”ë©´ -->
        <div id="splashScreen" aria-label="MysticTell Splash">
            <button class="start-image-btn" id="startBtn" aria-label="Start"></button>
        </div>

        <!-- ë©”ì¸ ì½˜í…ì¸  -->
        <div id="mainContent">
            <div class="header">
                <div class="logo">ğŸ”® MysticTell</div>
                <div class="subtitle">ì‹ ë¹„ë¡œìš´ ë¯¸ë˜ë¥¼ ì•Œë ¤ë“œë¦¬ëŠ” ë””ì§€í„¸ ì ìˆ ì‚¬</div>
                <div id="mainCrystal">êµ¬ìŠ¬ ì† ë¯¸ë˜ë¥¼<br/>í™•ì¸í•´ë³´ì„¸ìš”</div>
            </div>

            <!-- í™ˆ í˜ì´ì§€ -->
            <section id="page-home" class="page show">
                <div class="section-title">âœ¨ í•µì‹¬ ìš´ì„¸ ì„œë¹„ìŠ¤</div>
                <div class="service-grid">
                    <div class="service-item" data-route="fortune-today">
                        <span class="service-icon">ğŸ—“ï¸</span>
                        <div class="service-name">ì˜¤ëŠ˜ì˜ ìš´ì„¸</div>
                        <div class="service-desc">ë§¤ì¼ ìƒˆë¡œìš´ ìš´ì„¸ë¥¼ í™•ì¸í•˜ì„¸ìš”</div>
                    </div>
                    <div class="service-item" data-route="fortune-lotto">
                        <div class="service-icon">ğŸ²</div>
                        <div class="service-name">í–‰ìš´ë²ˆí˜¸</div>
                        <div class="service-desc">í†µê³„ ê¸°ë°˜ ë¡œë˜ ë²ˆí˜¸</div>
                    </div>
                    <div class="service-item" data-route="fortune-saju">
                        <span class="service-icon">ğŸ“œ</span>
                        <div class="service-name">ì •í†µ ì‚¬ì£¼</div>
                        <div class="service-desc">ìƒë…„ì›”ì¼ë¡œ ë³´ëŠ” ì¸ìƒ ìš´ì„¸</div>
                    </div>
                    <div class="service-item" data-route="fortune-tarot">
                        <span class="service-icon">ğŸƒ</span>
                        <div class="service-name">íƒ€ë¡œ ì </div>
                        <div class="service-desc">ì¹´ë“œê°€ ì „í•˜ëŠ” ë¯¸ë˜ ë©”ì‹œì§€</div>
                    </div>
                </div>

                <div class="section-title">ğŸŒŸ íŠ¹ë³„ ì„œë¹„ìŠ¤</div>
                <div class="special-grid">
                    <div class="special-item" data-route="fortune-match">
                        <div class="special-icon">ğŸ’•</div>
                        <div class="special-title">ê¶í•© ë³´ê¸°</div>
                        <div class="special-desc">ë‘ ì‚¬ëŒì˜ ìš´ëª…ì  ë§Œë‚¨</div>
                    </div>
                    <div class="special-item" data-route="fortune-year">
                        <div class="special-icon">ğŸŠ</div>
                        <div class="special-title">ì‹ ë…„ ìš´ì„¸</div>
                        <div class="special-desc">2025ë…„ í•œ í•´ ìš´ì„¸</div>
                    </div>
                </div>
            </section>

            <!-- ìš´ì„¸ í˜ì´ì§€ -->
            <section id="page-fortune" class="page">
                <div class="section-title" id="fortuneTitle">ìš´ì„¸</div>

                <!-- ì˜¤ëŠ˜ì˜ ìš´ì„¸ -->
                <div id="view-today" class="card" style="display:none;">
                    <div class="field">
                        <div class="label">ìƒë…„ì›”ì¼</div>
                        <input class="input" type="date" id="today-birth" />
                    </div>
                    <div class="field">
                        <div class="label">ì´ë¦„ (ì„ íƒ)</div>
                        <input class="input" type="text" id="today-name" placeholder="ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”" />
                    </div>
                    <div class="field">
                        <div class="label">ë‹¬ë ¥</div>
                        <div style="display: flex; gap: 10px; align-items: center;">
                            <label><input type="radio" name="today-cal" id="today-cal-solar" value="solar" checked> ì–‘ë ¥</label>
                            <label><input type="radio" name="today-cal" id="today-cal-lunar" value="lunar"> ìŒë ¥</label>
                            <label style="margin-left:8px;"><input type="checkbox" id="today-leap"> ìœ¤ë‹¬</label>
                        </div>
                    </div>
                    <button class="btn" id="btnToday">ì˜¤ëŠ˜ì˜ ìš´ì„¸ ë³´ê¸°</button>
                </div>

                <!-- ì •í†µ ì‚¬ì£¼ -->
                <div id="view-saju" class="card" style="display:none;">
                    <div class="field">
                        <div class="label">ìƒë…„ì›”ì¼</div>
                        <input class="input" type="date" id="saju-birth" />
                    </div>
                    <div class="field">
                        <div class="label">ì´ë¦„ (ì„ íƒ)</div>
                        <input class="input" type="text" id="saju-name" placeholder="ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”" />
                    </div>
                    <div class="field">
                        <div class="label">ì„±ë³„</div>
                        <select id="saju-gender" class="input">
                            <option value="F">ì—¬ì„±</option>
                            <option value="M">ë‚¨ì„±</option>
                        </select>
                    </div>
                    <div class="field">
                        <div class="label">íƒœì–´ë‚œ ì‹œê°„ (ì„ íƒ)</div>
                        <input class="input" type="time" id="saju-time" step="900" placeholder="ì˜ˆ: 13:30" />
                    </div>
                    <div class="field">
                        <div class="label">ë‹¬ë ¥</div>
                        <div style="display: flex; gap: 10px; align-items: center;">
                            <label><input type="radio" name="saju-cal" id="saju-cal-solar" value="solar" checked> ì–‘ë ¥</label>
                            <label><input type="radio" name="saju-cal" id="saju-cal-lunar" value="lunar"> ìŒë ¥</label>
                            <label style="margin-left:8px;"><input type="checkbox" id="saju-leap"> ìœ¤ë‹¬</label>
                        </div>
                    </div>
                    <button class="btn" id="btnSaju">ì‚¬ì£¼ í•´ì„ ë³´ê¸°</button>
                </div>

                <!-- í–‰ìš´ë²ˆí˜¸ -->
                <div id="view-lotto" class="card" style="display:none;">
                    <h3 style="margin-bottom: 20px; text-align: center; color: #667eea;">ğŸ² í–‰ìš´ì˜ ë¡œë˜ë²ˆí˜¸</h3>
                    <p style="text-align: center; color: #666; margin-bottom: 25px; font-style: italic;">
                        ì‹¤ì œ í†µê³„ + ê°œì¸ í–‰ìš´ìˆ˜ ì¡°í•©
                    </p>
                    <div class="field">
                        <div class="label">ìƒë…„ì›”ì¼ (ì„ íƒì‚¬í•­)</div>
                        <input type="text" id="lotto-birth" placeholder="1990-01-01" class="input">
                        <small style="color: #666;">ê°œì¸ë§ì¶¤ í–‰ìš´ë²ˆí˜¸ë¥¼ ìœ„í•´ ì…ë ¥í•˜ì„¸ìš”!</small>
                    </div>
                    <button id="btnLotto" class="btn">
                        ğŸ² í–‰ìš´ë²ˆí˜¸ ìƒì„±í•˜ê¸°
                    </button>
                    <div style="margin-top: 16px; font-size: 12px; color: #666; text-align: center;">
                        ğŸ’¡ ê°€ì¥ ìì£¼ ë‚˜ì˜¨ ë²ˆí˜¸ë“¤ê³¼ ê°œì¸ í–‰ìš´ìˆ˜ì˜ ì¡°í•©
                    </div>
                </div>

                <!-- íƒ€ë¡œ -->
                <div id="view-tarot" class="card" style="display:none;">
                    <h3 style="margin-bottom: 20px; text-align: center; color: #667eea;">ğŸ”® íƒ€ë¡œ ì¹´ë“œ ì </h3>
                    <p style="text-align: center; color: #666; margin-bottom: 25px; font-style: italic;">
                        ğŸŒŸ ë§ˆìŒì„ ì§‘ì¤‘í•˜ê³  ì¹´ë“œë¥¼ ì„ íƒí•˜ì„¸ìš”
                    </p>
                    
                    <div class="tarot-card-selection">
                        <div class="tarot-row">
                            <div class="tarot-card-back" data-card-index="0">
                                <div class="card-back-design">ğŸŒŸ</div>
                            </div>
                            <div class="tarot-card-back" data-card-index="1">
                                <div class="card-back-design">ğŸŒŸ</div>
                            </div>
                            <div class="tarot-card-back" data-card-index="2">
                                <div class="card-back-design">ğŸŒŸ</div>
                            </div>
                            <div class="tarot-card-back" data-card-index="3">
                                <div class="card-back-design">ğŸŒŸ</div>
                            </div>
                        </div>
                        <div class="tarot-row">
                            <div class="tarot-card-back" data-card-index="4">
                                <div class="card-back-design">ğŸŒŸ</div>
                            </div>
                            <div class="tarot-card-back" data-card-index="5">
                                <div class="card-back-design">ğŸŒŸ</div>
                            </div>
                            <div class="tarot-card-back" data-card-index="6">
                                <div class="card-back-design">ğŸŒŸ</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="tarot-actions">
                        <button id="btnRandomTarot" class="btn" style="background: linear-gradient(135deg, #8e44ad, #9b59b6);">
                            ğŸ² ëœë¤ ë½‘ê¸°
                        </button>
                        <button id="btnResetTarot" class="btn btn-ghost">ğŸ”„ ë‹¤ì‹œ ì‹œì‘</button>
                    </div>
                </div>

                <!-- ê¶í•© ë³´ê¸° -->
                <div id="view-match" class="card" style="display:none;">
                    <div class="field">
                        <div class="label">ë‹¹ì‹ ì˜ ìƒë…„ì›”ì¼</div>
                        <input class="input" type="date" id="match-a" />
                    </div>
                    <div class="field">
                        <div class="label">ìƒëŒ€ì˜ ìƒë…„ì›”ì¼</div>
                        <input class="input" type="date" id="match-b" />
                    </div>
                    <button class="btn" id="btnMatch">ê¶í•© í™•ì¸</button>
                </div>

                <!-- ì‹ ë…„ ìš´ì„¸ -->
                <div id="view-year" class="card" style="display:none;">
                    <div class="field">
                        <div class="label">ìƒë…„ì›”ì¼</div>
                        <input class="input" type="date" id="year-birth" />
                    </div>
                    <button class="btn" id="btnYear">2025 ì‹ ë…„ ìš´ì„¸</button>
                </div>
            </section>

            <!-- ìƒë‹´ í˜ì´ì§€ -->
            <section id="page-chat" class="page">
                <div class="card">
                    <div class="label" style="margin-bottom:8px;">ìƒë‹´ ì¤€ë¹„ì¤‘</div>
                    <div style="font-size:14px;color:#555;">ê³§ ì „ë¬¸ê°€ì™€ 1:1 ìƒë‹´ ê¸°ëŠ¥ì´ ì—´ë¦½ë‹ˆë‹¤.</div>
                </div>
            </section>

            <!-- ë§ˆì´ í˜ì´ì§€ -->
            <section id="page-me" class="page">
                <div class="card">
                    <div class="label" style="margin-bottom:8px;">ë§ˆì´ í˜ì´ì§€(ë¡œì»¬)</div>
                    <div style="font-size:14px;color:#555;">ìµœê·¼ ê²°ê³¼ê°€ ì´ ê¸°ê¸°(ë¸Œë¼ìš°ì €)ì— ì €ì¥ë©ë‹ˆë‹¤.</div>
                    <button class="btn" id="btnClear" style="margin-top:12px;">ìµœê·¼ ê²°ê³¼ ëª¨ë‘ ì‚­ì œ</button>
                </div>
            </section>

            <div class="spacer"></div>
        </div>

        <!-- í•˜ë‹¨ ë„¤ë¹„ê²Œì´ì…˜ -->
        <div id="bottomNav">
            <div class="nav-item active" data-tab="home">
                <div class="nav-icon">ğŸ </div>
                <div class="nav-text">í™ˆ</div>
            </div>
            <div class="nav-item" data-tab="fortune">
                <div class="nav-icon">ğŸ”®</div>
                <div class="nav-text">ìš´ì„¸</div>
            </div>
            <div class="nav-item" data-tab="chat">
                <div class="nav-icon">ğŸ’¬</div>
                <div class="nav-text">ìƒë‹´</div>
            </div>
            <div class="nav-item" data-tab="me">
                <div class="nav-icon">ğŸ‘¤</div>
                <div class="nav-text">ë§ˆì´</div>
            </div>
        </div>
    </div>

    <!-- ê²°ê³¼ ì‹œíŠ¸ -->
    <div id="sheetBackdrop" role="dialog" aria-modal="true" aria-labelledby="sheetTitle">
        <div class="sheet" role="document">
            <div class="sheet-header">
                <div id="sheetTitle">ê²°ê³¼</div>
                <button id="btnClose">âœ•</button>
            </div>
            <div id="sheetContent">ë‚´ìš©</div>
            <div class="sheet-actions">
                <button class="btn" id="btnSave">ìµœê·¼ ê²°ê³¼ ì €ì¥</button>
            </div>
        </div>
    </div>

    <!-- íƒ€ë¡œ ëª¨ë‹¬ -->
    <div id="tarotModalOverlay">
        <div class="tarot-modal" id="tarotModal">
            <button id="tarotCloseBtn">âœ•</button>
            <div id="tarotModalContent">
                <!-- ëª¨ë‹¬ ë‚´ìš©ì´ JavaScriptë¡œ ì±„ì›Œì§ -->
            </div>
        </div>
    </div>

    <!-- ë¼ì´ë¸ŒëŸ¬ë¦¬ -->
    <script src="https://cdn.jsdelivr.net/npm/lunar-javascript@1.6.12/lunar.min.js"></script>
    
    <!-- ë©”ì¸ JavaScript -->
    <script>
        // ===========================================
        // ì „ì—­ ë³€ìˆ˜ ë° í—¬í¼ í•¨ìˆ˜
        // ===========================================
        const $ = (sel) => document.querySelector(sel);
        const $$ = (sel) => Array.from(document.querySelectorAll(sel));
        const LS_KEY = 'mystictell_recent_results';

        // ===========================================
        // ìŠ¤í”Œë˜ì‹œ ê´€ë¦¬
        // ===========================================
        function hideSplash() {
            const splash = $('#splashScreen');
            const main = $('#mainContent');
            const nav = $('#bottomNav');

            console.log('ğŸ”® ìŠ¤í”Œë˜ì‹œ ìˆ¨ê¹€ ì‹œì‘...');

            if (splash) {
                splash.classList.add('hidden');
                console.log('âœ… ìŠ¤í”Œë˜ì‹œ ìŠ¤í¬ë¦° ìˆ¨ê¹€ ì™„ë£Œ');
            }

            if (main) {
                main.style.display = 'block';
                main.classList.add('show');
                console.log('âœ… ë©”ì¸ ì½˜í…ì¸  í‘œì‹œ ì™„ë£Œ');
            }

            if (nav) {
                nav.style.display = 'flex';
                nav.classList.add('show');
                console.log('âœ… ë„¤ë¹„ê²Œì´ì…˜ í‘œì‹œ ì™„ë£Œ');
            }
        }

        // ===========================================
        // í˜ì´ì§€ ë° ë·° ê´€ë¦¬
        // ===========================================
        const pages = {
            home: () => $('#page-home'),
            fortune: () => $('#page-fortune'),
            chat: () => $('#page-chat'),
            me: () => $('#page-me')
        };

        const views = {
            'fortune-today': $('#view-today'),
            'fortune-saju': $('#view-saju'),
            'fortune-tarot': $('#view-tarot'),
            'fortune-match': $('#view-match'),
            'fortune-year': $('#view-year'),
            'fortune-lotto': $('#view-lotto')
        };

        function setActiveTab(tab) {
            // íƒ­ í™œì„±í™”
            $$('.nav-item').forEach(n => n.classList.toggle('active', n.dataset.tab === tab));
            
            // í˜ì´ì§€ í‘œì‹œ
            Object.entries(pages).forEach(([k, pageGetter]) => {
                const page = pageGetter();
                if (page) {
                    page.classList.toggle('show', k === tab);
                    page.style.display = k === tab ? 'block' : 'none';
                }
            });
            
            closeAllOverlays();
        }

        function showFortuneView(route) {
            const fortuneTitle = $('#fortuneTitle');
            
            // ëª¨ë“  ë·° ìˆ¨ê¸°ê¸°
            Object.values(views).forEach(v => {
                if (v) v.style.display = 'none';
            });
            
            // ì„ íƒëœ ë·° í‘œì‹œ
            const viewElement = views[route];
            if (viewElement) {
                viewElement.style.display = 'block';
            }
            
            // ì œëª© ì„¤ì •
            const titles = {
                'fortune-today': 'ì˜¤ëŠ˜ì˜ ìš´ì„¸',
                'fortune-saju': 'ì •í†µ ì‚¬ì£¼',
                'fortune-tarot': 'íƒ€ë¡œ ì ',
                'fortune-match': 'ê¶í•© ë³´ê¸°',
                'fortune-year': 'ì‹ ë…„ ìš´ì„¸ (2025)',
                'fortune-lotto': 'í–‰ìš´ë²ˆí˜¸'
            };
            
            if (fortuneTitle) {
                fortuneTitle.textContent = titles[route] || 'ì¤€ë¹„ì¤‘';
            }
            
            // íŠ¹ë³„ ì´ˆê¸°í™”
            if (route === 'fortune-tarot') {
                setTimeout(() => initializeTarot(), 50);
            }
            
            reactCrystal(`${titles[route] || 'ì„œë¹„ìŠ¤'}ë¥¼ ì¤€ë¹„í•©ë‹ˆë‹¤...`);
        }

        // ===========================================
        // ë¼ìš°íŒ…
        // ===========================================
        function routeFromHash() {
            const hash = location.hash || '#/home';
            const match = hash.match(/^#\/([^/]+)(?:\/([^/]+))?/);
            const tab = match?.[1] || 'home';
            const sub = match?.[2] || '';

            console.log('ğŸ”„ ë¼ìš°íŒ…:', tab, sub);

            // íƒ­ ì„¤ì •
            if (['home', 'fortune', 'chat', 'me'].includes(tab)) {
                setActiveTab(tab);
            } else {
                setActiveTab('home');
            }

            // ìš´ì„¸ ì„œë¸Œë·° ì„¤ì •
            if (tab === 'fortune') {
                const viewMap = {
                    'today': 'fortune-today',
                    'saju': 'fortune-saju',
                    'tarot': 'fortune-tarot',
                    'match': 'fortune-match',
                    'year': 'fortune-year',
                    'lotto': 'fortune-lotto'
                };
                showFortuneView(viewMap[sub] || 'fortune-today');
            }
        }

        // ===========================================
        // í¬ë¦¬ìŠ¤íƒˆ ë°˜ì‘
        // ===========================================
        function reactCrystal(text) {
            const crystal = $('#mainCrystal');
            if (!crystal) return;
            
            crystal.style.background = 'radial-gradient(circle at 30% 30%, rgba(255,215,0,.9), rgba(255,20,147,.7), rgba(138,43,226,.5))';
            crystal.innerHTML = 'ğŸ”®<br>ë¶„ì„ì¤‘...';
            
            setTimeout(() => {
                crystal.innerHTML = text || 'âœ¨ ì¤€ë¹„ì¤‘ì…ë‹ˆë‹¤...';
            }, 800);
            
            setTimeout(() => {
                crystal.style.background = 'radial-gradient(circle at 30% 30%, rgba(255,255,255,.8), rgba(255,255,255,.3), transparent)';
                crystal.innerHTML = 'êµ¬ìŠ¬ ì† ë¯¸ë˜ë¥¼<br>í™•ì¸í•´ë³´ì„¸ìš”';
            }, 2800);
        }

        // ===========================================
        // ì‹œíŠ¸ ê´€ë¦¬
        // ===========================================
        const sheet = $('#sheetBackdrop');
        const sheetTitle = $('#sheetTitle');
        const sheetContent = $('#sheetContent');
        let lastResult = null;

        function openSheet(title, content, savePayload) {
            if (!sheet || !sheetTitle || !sheetContent) return;
            
            sheetTitle.textContent = title;
            
            if (typeof content === 'string' && content.includes('<')) {
                sheetContent.innerHTML = content;
            } else {
                sheetContent.textContent = content?.toString?.() || '';
            }
            
            sheet.classList.add('show');
            lastResult = savePayload || null;
            document.body.style.overflow = 'hidden';
        }

        function closeSheet() {
            if (!sheet) return;
            sheet.classList.remove('show');
            document.body.style.overflow = '';
        }

        function closeAllOverlays() {
            closeSheet();
            closeTarotModal();
        }

        // ===========================================
        // ë¡œì»¬ìŠ¤í† ë¦¬ì§€ ê´€ë¦¬
        // ===========================================
        function pushRecent(item) {
            try {
                const arr = JSON.parse(localStorage.getItem(LS_KEY) || "[]");
                arr.unshift({ ...item, ts: Date.now() });
                localStorage.setItem(LS_KEY, JSON.stringify(arr.slice(0, 20)));
            } catch (e) {
                console.warn('LocalStorage error:', e);
            }
        }

        // ===========================================
        // ìš´ì„¸ ë°ì´í„°
        // ===========================================
        const FORTUNE_CATEGORIES = {
            total: {
                name: 'ì´ìš´',
                icon: 'ğŸŒŸ',
                messages: {
                    90: ['ì˜¤ëŠ˜ì€ ëª¨ë“  ì¼ì´ ìˆ ìˆ  í’€ë¦¬ëŠ” ìµœê³ ì˜ ë‚ ì…ë‹ˆë‹¤!', 'í–‰ìš´ì˜ ì—¬ì‹ ì´ í•¨ê»˜í•˜ëŠ” íŠ¹ë³„í•œ í•˜ë£¨ê°€ ë  ê²ƒì…ë‹ˆë‹¤!'],
                    80: ['ê¸ì •ì ì¸ ì—ë„ˆì§€ê°€ ë„˜ì¹˜ëŠ” ì¢‹ì€ ë‚ ì…ë‹ˆë‹¤!', 'ì‘ì€ ê¸°ì ë“¤ì´ ì¼ì–´ë‚  ìˆ˜ ìˆëŠ” ë‚ ì…ë‹ˆë‹¤!'],
                    70: ['ì•ˆì •ì ì´ê³  í‰í™”ë¡œìš´ í•˜ë£¨ê°€ ë  ê²ƒì…ë‹ˆë‹¤!', 'ì°¨ê·¼ì°¨ê·¼ ì§„í–‰í•˜ë©´ ì¢‹ì€ ì„±ê³¼ë¥¼ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤!'],
                    60: ['ì¡°ê¸ˆë§Œ ë” ë…¸ë ¥í•˜ë©´ ì›í•˜ëŠ” ê²°ê³¼ë¥¼ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤!', 'ì¸ë‚´ì‹¬ì„ ê°–ê³  ê¾¸ì¤€íˆ ë‚˜ì•„ê°€ì„¸ìš”!'],
                    50: ['í˜„ìƒ ìœ ì§€í•˜ë©° ì•ˆì „í•˜ê²Œ ì§€ë‚´ëŠ” ê²ƒì´ ì¢‹ê² ìŠµë‹ˆë‹¤!', 'ê¸‰í•˜ê²Œ ì„œë‘ë¥´ì§€ ë§ê³  ì‹ ì¤‘í•˜ê²Œ íŒë‹¨í•˜ì„¸ìš”!'],
                    40: ['ì¡°ì‹¬ìŠ¤ëŸ½ê²Œ í–‰ë™í•˜ê³  ì‹ ì¤‘í•œ ê²°ì •ì„ ë‚´ë¦¬ì„¸ìš”!', 'ì‘ì€ ì¼ë¶€í„° ì°¨ê·¼ì°¨ê·¼ í•´ê²°í•´ë‚˜ê°€ì„¸ìš”!'],
                    30: ['ì˜¤ëŠ˜ì€ ë¬´ë¦¬í•˜ì§€ ë§ê³  ì—¬ìœ ë¡­ê²Œ ì§€ë‚´ì„¸ìš”!', 'ìŠ¤íŠ¸ë ˆìŠ¤ë¥¼ ì¤„ì´ê³  ë§ˆìŒì˜ í‰í™”ë¥¼ ì°¾ìœ¼ì„¸ìš”!']
                }
            },
            love: {
                name: 'ì—°ì• ìš´',
                icon: 'ğŸ’•',
                messages: {
                    90: ['ìš´ëª…ì ì¸ ë§Œë‚¨ì´ ê¸°ë‹¤ë¦¬ê³  ìˆì„ì§€ë„ ëª°ë¼ìš”!', 'ì‚¬ë‘í•˜ëŠ” ì‚¬ëŒê³¼ì˜ ê´€ê³„ê°€ í•œì¸µ ë” ê¹Šì–´ì§ˆ ê²ƒì…ë‹ˆë‹¤!'],
                    80: ['ë‹¬ì½¤í•œ ì‚¬ë‘ì˜ ê¸°ìš´ì´ ê°€ë“í•œ í•˜ë£¨ì…ë‹ˆë‹¤!', 'ì¢‹ì•„í•˜ëŠ” ì‚¬ëŒê³¼ì˜ ê±°ë¦¬ê°€ ê°€ê¹Œì›Œì§ˆ ê²ƒì…ë‹ˆë‹¤!'],
                    70: ['ë”°ëœ»í•œ ë§ˆìŒì„ ë‚˜ëˆ„ëŠ” í‰ì˜¨í•œ ì—°ì• ìš´ì…ë‹ˆë‹¤!', 'ì„œë¡œë¥¼ ì´í•´í•˜ê³  ë°°ë ¤í•˜ëŠ” ì‹œê°„ì„ ê°€ì ¸ë³´ì„¸ìš”!'],
                    60: ['ì¡°ê¸ˆ ë” ì ê·¹ì ìœ¼ë¡œ ë§ˆìŒì„ í‘œí˜„í•´ë³´ì„¸ìš”!', 'ìƒëŒ€ë°©ì˜ ì…ì¥ì—ì„œ ìƒê°í•´ë³´ëŠ” ê²ƒì´ ì¤‘ìš”í•©ë‹ˆë‹¤!'],
                    50: ['ì„£ë¶€ë¥¸ ê³ ë°±ë³´ë‹¤ëŠ” ì²œì²œíˆ ê´€ê³„ë¥¼ ë°œì „ì‹œí‚¤ì„¸ìš”!', 'ê°ì •ì ì¸ íŒë‹¨ë³´ë‹¤ëŠ” ì´ì„±ì ì¸ ì ‘ê·¼ì´ í•„ìš”í•©ë‹ˆë‹¤!'],
                    40: ['ì—°ì• ë³´ë‹¤ëŠ” ìê¸°ê³„ë°œì— ì§‘ì¤‘í•˜ëŠ” ê²ƒì´ ì¢‹ê² ìŠµë‹ˆë‹¤!', 'ê°ˆë“±ì´ ìƒê¸¸ ìˆ˜ ìˆìœ¼ë‹ˆ ë§ì¡°ì‹¬í•˜ì„¸ìš”!'],
                    30: ['ì˜¤ëŠ˜ì€ ì—°ì•  ë¬¸ì œë¡œ ìŠ¤íŠ¸ë ˆìŠ¤ë°›ì§€ ë§ˆì„¸ìš”!', 'ì¹œêµ¬ë“¤ê³¼ì˜ ì‹œê°„ì„ ë” ì†Œì¤‘íˆ ì—¬ê¸°ì„¸ìš”!']
                }
            },
            money: {
                name: 'ì¬ë¬¼ìš´',
                icon: 'ğŸ’°',
                messages: {
                    90: ['ì˜ˆìƒì¹˜ ëª»í•œ ìˆ˜ì…ì´ë‚˜ ë³´ë„ˆìŠ¤ê°€ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤!', 'íˆ¬ìë‚˜ ì‚¬ì—…ì—ì„œ í° ì„±ê³¼ë¥¼ ê±°ë‘˜ ê²ƒì…ë‹ˆë‹¤!'],
                    80: ['ëˆ ê´€ë¦¬ë¥¼ ì˜í•˜ë©´ ëª©ëˆì„ ë§Œë“¤ ìˆ˜ ìˆì„ ê²ƒì…ë‹ˆë‹¤!', 'ë¶€ì—…ì´ë‚˜ ì‚¬ì´ë“œ í”„ë¡œì íŠ¸ì—ì„œ ìˆ˜ìµì´ ìƒê¸¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤!'],
                    70: ['ì•ˆì •ì ì¸ ìˆ˜ì…ê³¼ ì§€ì¶œ ê´€ë¦¬ê°€ ì´ë£¨ì–´ì§ˆ ê²ƒì…ë‹ˆë‹¤!', 'ê³„íšì ì¸ ì €ì¶•ìœ¼ë¡œ ë¯¸ë˜ë¥¼ ì¤€ë¹„í•˜ì„¸ìš”!'],
                    60: ['ê°€ê³„ë¶€ë¥¼ ì‘ì„±í•˜ë©° ëˆì˜ íë¦„ì„ íŒŒì•…í•´ë³´ì„¸ìš”!', 'ë¶ˆí•„ìš”í•œ ì§€ì¶œì„ ì¤„ì´ëŠ” ê²ƒì´ ì¤‘ìš”í•©ë‹ˆë‹¤!'],
                    50: ['í° ì§€ì¶œì€ í”¼í•˜ê³  í˜„ìƒ ìœ ì§€ì— ì§‘ì¤‘í•˜ì„¸ìš”!', 'ì¶©ë™êµ¬ë§¤ë¥¼ ìì œí•˜ê³  ì‹ ì¤‘í•˜ê²Œ ì†Œë¹„í•˜ì„¸ìš”!'],
                    40: ['ëˆ ë¬¸ì œë¡œ ìŠ¤íŠ¸ë ˆìŠ¤ë°›ì§€ ì•Šë„ë¡ ì£¼ì˜í•˜ì„¸ìš”!', 'ëŒ€ì¶œì´ë‚˜ íˆ¬ìëŠ” ì‹ ì¤‘í•˜ê²Œ ê²°ì •í•˜ì„¸ìš”!'],
                    30: ['ì˜¤ëŠ˜ì€ ì§€ê°‘ì„ ë‹¨ë‹¨íˆ ë‹«ì•„ë‘ì„¸ìš”!', 'ê¸ˆì „ ê±°ë˜ëŠ” ìµœëŒ€í•œ í”¼í•˜ëŠ” ê²ƒì´ ì¢‹ê² ìŠµë‹ˆë‹¤!']
                }
            }
        };

        const LUCKY_ITEMS = {
            items: ['ë°˜ì§€', 'ëª©ê±¸ì´', 'ì‹œê³„', 'í–¥ìˆ˜', 'ë¦½ë°¤', 'ì°¨í‚¤', 'ì§€ê°‘', 'ìŠ¤ë§ˆíŠ¸í° ì¼€ì´ìŠ¤'],
            colors: ['ë¹¨ê°•', 'íŒŒë‘', 'ë…¸ë‘', 'ì´ˆë¡', 'ë³´ë¼', 'ë¶„í™', 'í•˜ëŠ˜ìƒ‰', 'ì£¼í™©'],
            numbers: ['3', '7', '9', '12', '21', '27', '33', '42'],
            directions: ['ë™ìª½', 'ì„œìª½', 'ë‚¨ìª½', 'ë¶ìª½', 'ë™ë‚¨ìª½', 'ë™ë¶ìª½', 'ì„œë‚¨ìª½', 'ì„œë¶ìª½']
        };

        // ===========================================
        // ìš´ì„¸ ê³„ì‚°
        // ===========================================
        function calcEnhancedDailyFortune(birthdate) {
            const today = new Date();
            const dateStr = `${today.getFullYear()}-${today.getMonth() + 1}-${today.getDate()}`;
            const results = {};

            Object.keys(FORTUNE_CATEGORIES).forEach((category, index) => {
                const seed = (birthdate || '').replaceAll('-', '') + dateStr + category + index;
                let hash = 0;
                for (let i = 0; i < seed.length; i++) {
                    hash = (hash * 37 + seed.charCodeAt(i)) % 100000;
                }
                const score = Math.abs(hash) % 100;

                let messageKey = 30;
                if (score >= 85) messageKey = 90;
                else if (score >= 75) messageKey = 80;
                else if (score >= 65) messageKey = 70;
                else if (score >= 55) messageKey = 60;
                else if (score >= 45) messageKey = 50;
                else if (score >= 35) messageKey = 40;

                const messages = FORTUNE_CATEGORIES[category].messages[messageKey];
                const messageIndex = Math.abs(hash) % messages.length;

                results[category] = {
                    name: FORTUNE_CATEGORIES[category].name,
                    icon: FORTUNE_CATEGORIES[category].icon,
                    score: score,
                    message: messages[messageIndex]
                };
            });

            // ëŸ­í‚¤ ì•„ì´í…œ ìƒì„±
            const luckyHash = birthdate.replaceAll('-', '') + dateStr + 'lucky';
            let lHash = 0;
            for (let i = 0; i < luckyHash.length; i++) {
                lHash = (lHash * 41 + luckyHash.charCodeAt(i)) % 100000;
            }

            return {
                categories: results,
                lucky: {
                    item: LUCKY_ITEMS.items[Math.abs(lHash) % LUCKY_ITEMS.items.length],
                    color: LUCKY_ITEMS.colors[Math.abs(lHash + 1) % LUCKY_ITEMS.colors.length],
                    number: LUCKY_ITEMS.numbers[Math.abs(lHash + 2) % LUCKY_ITEMS.numbers.length],
                    direction: LUCKY_ITEMS.directions[Math.abs(lHash + 3) % LUCKY_ITEMS.directions.length]
                },
                date: dateStr
            };
        }

        // ===========================================
        // ê²°ê³¼ ë Œë”ë§
        // ===========================================
        function createResultCard(icon, title, value, description, isMain = false, cardType = '') {
            let cardClass = 'result-card';
            if (isMain) cardClass += ' main-result';
            if (cardType) cardClass += ' ' + cardType;

            return `
            <div class="${cardClass}">
                <div class="card-header">
                    <div class="card-icon">${icon}</div>
                    <div class="card-title">${title}</div>
                </div>
                <div class="card-value">${value}</div>
                <div class="card-description">${description}</div>
            </div>
            `;
        }

        function renderEnhancedDailyFortune(fortuneData, name = '') {
            const nameTitle = name ? `<b>${name}</b>ë‹˜ì˜ ` : '';

            let html = `
            <div class="result-section">
                <div class="section-title-result">ğŸŒŸ ${nameTitle}ì˜¤ëŠ˜ì˜ ìš´ì„¸</div>
                <div class="fortune-date">ğŸ“… ${fortuneData.date}</div>
            </div>
            `;

            // ê° ì¹´í…Œê³ ë¦¬ë³„ ìš´ì„¸ ì¹´ë“œ
            html += '<div class="result-section">';
            Object.values(fortuneData.categories).forEach((category, index) => {
                const isMainCard = index === 0;
                html += createResultCard(
                    category.icon,
                    category.name,
                    `${category.score}ì `,
                    category.message,
                    isMainCard,
                    'fortune-card'
                );
            });
            html += '</div>';

            // ëŸ­í‚¤ ì •ë³´ ì„¹ì…˜
            html += `
            <div class="result-section">
                <div class="section-title-result">ğŸ€ ì˜¤ëŠ˜ì˜ ëŸ­í‚¤ ì•„ì´í…œ</div>
                <div class="lucky-items-grid">
                    <div class="lucky-item-card">
                        <div class="lucky-icon">ğŸ</div>
                        <div class="lucky-label">ëŸ­í‚¤ ì•„ì´í…œ</div>
                        <div class="lucky-value">${fortuneData.lucky.item}</div>
                    </div>
                    <div class="lucky-item-card">
                        <div class="lucky-icon">ğŸ¨</div>
                        <div class="lucky-label">ëŸ­í‚¤ ì»¬ëŸ¬</div>
                        <div class="lucky-value">${fortuneData.lucky.color}</div>
                    </div>
                    <div class="lucky-item-card">
                        <div class="lucky-icon">ğŸ”¢</div>
                        <div class="lucky-label">ëŸ­í‚¤ ë„˜ë²„</div>
                        <div class="lucky-value">${fortuneData.lucky.number}</div>
                    </div>
                    <div class="lucky-item-card">
                        <div class="lucky-icon">ğŸ§­</div>
                        <div class="lucky-label">ëŸ­í‚¤ ë°©í–¥</div>
                        <div class="lucky-value">${fortuneData.lucky.direction}</div>
                    </div>
                </div>
            </div>
            `;

            return html;
        }

        // ===========================================
        // ë¡œë˜ ë²ˆí˜¸ ìƒì„±
        // ===========================================
        function generateLottoNumbers(birthStr = '') {
            const today = new Date();
            const weekKey = getISOWeek(today);
            const seed = weekKey + (birthStr || '');
            
            let hash = 0;
            for (let i = 0; i < seed.length; i++) {
                hash = (hash * 31 + seed.charCodeAt(i)) & 0x7fffffff;
            }
            
            const rng = seededRandom(hash);
            const numbers = [];
            
            while (numbers.length < 6) {
                const num = Math.floor(rng() * 45) + 1;
                if (!numbers.includes(num)) {
                    numbers.push(num);
                }
            }
            
            const bonus = Math.floor(rng() * 45) + 1;
            
            return {
                main: numbers.sort((a, b) => a - b),
                bonus: bonus,
                seedInfo: `ì£¼ ${weekKey}${birthStr ? ` Â· ${birthStr}` : ''}`
            };
        }

        function seededRandom(seed) {
            let state = seed;
            return function() {
                state = (state * 1664525 + 1013904223) >>> 0;
                return state / 0xFFFFFFFF;
            };
        }

        function getISOWeek(date) {
            const target = new Date(date.valueOf());
            const dayNr = (date.getDay() + 6) % 7;
            target.setDate(target.getDate() - dayNr + 3);
            const firstThursday = target.valueOf();
            target.setMonth(0, 1);
            if (target.getDay() !== 4) {
                target.setMonth(0, 1 + ((4 - target.getDay()) + 7) % 7);
            }
            return 1 + Math.ceil((firstThursday - target) / 604800000);
        }

        function renderLottoResult(result) {
            if (!result || !Array.isArray(result.main)) {
                return `
                <div class="info-box">
                    <div class="info-title">â„¹ï¸ ì•ˆë‚´</div>
                    <div class="info-content">ë²ˆí˜¸ ìƒì„±ì— ì‹¤íŒ¨í–ˆì–´ìš”. ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.</div>
                </div>`;
            }

            const ballsHtml = result.main
                .map(n => `<div class="ball">${String(n).padStart(2, '0')}</div>`)
                .join('');

            const bonusHtml = result.bonus ? 
                `<div style="align-self:center;font-weight:800;margin:0 4px">+</div>
                 <div class="ball bonus">${String(result.bonus).padStart(2, '0')}</div>` : '';

            return `
            <div class="result-section lotto-wrap">
                <div class="section-title-result">ğŸ± í–‰ìš´ë²ˆí˜¸</div>
                <div class="lotto-balls">
                    ${ballsHtml}
                    ${bonusHtml}
                </div>
                <div class="lotto-meta">ìƒì„± ê¸°ì¤€: ${result.seedInfo || 'ëœë¤'} Â· ì°¸ê³ ìš©</div>
            </div>
            <div class="info-box">
                <div class="info-title">â„¹ï¸ ì•ˆë‚´</div>
                <div class="info-content">
                    â€¢ ê²°ê³¼ëŠ” <strong>ê°™ì€ ì£¼(ISO ì£¼)</strong>ì—ëŠ” ë™ì¼í•©ë‹ˆë‹¤.<br/>
                    â€¢ ì…ë ¥í•œ ìƒë…„ì›”ì¼ì´ ê°™ìœ¼ë©´ ê°™ì€ ì£¼ì—ëŠ” ê°™ì€ ì¶”ì²œì´ ë‚˜ì˜µë‹ˆë‹¤.<br/>
                    â€¢ ì¬ë¯¸/ì°¸ê³ ìš©ì´ë©°, ì±…ì„ìˆëŠ” êµ¬ë§¤ë¥¼ ê¶Œì¥í•´ìš”. ğŸ¯
                </div>
            </div>
            `;
        }

        // ===========================================
        // íƒ€ë¡œ ê´€ë ¨
        // ===========================================
        const TAROT_DETAILS = [
            {name: "THE FOOL (ë°”ë³´)", meaning: "ìƒˆë¡œìš´ ì‹œì‘ê³¼ ìˆœìˆ˜í•¨ì„ ë‚˜íƒ€ë‚´ëŠ” ì¹´ë“œì…ë‹ˆë‹¤.", upright: "ìƒˆë¡œìš´ ì‹œì‘, ìˆœì§„í•¨, ìë°œì„±", reversed: "ë¬´ëª¨í•¨, ê²½ì†”í•¨, ìœ„í—˜í•œ í–‰ë™"},
            {name: "THE MAGICIAN (ë§ˆë²•ì‚¬)", meaning: "ì˜ì§€ë ¥ê³¼ ì°½ì¡°ë ¥ì„ ë‚˜íƒ€ë‚´ëŠ” ì¹´ë“œì…ë‹ˆë‹¤.", upright: "ì˜ì§€ë ¥, ì°½ì¡°ë ¥, ì§‘ì¤‘", reversed: "ê¸°ë§Œ, ì¡°ì‘, ëŠ¥ë ¥ ë¶€ì¡±"},
            {name: "THE HIGH PRIESTESS (ì—¬êµí™©)", meaning: "ì§ê°ê³¼ ë‚´ë©´ì˜ ì§€í˜œë¥¼ ë‚˜íƒ€ë‚´ëŠ” ì¹´ë“œì…ë‹ˆë‹¤.", upright: "ì§ê°, ë¬´ì˜ì‹, ì‹ ë¹„", reversed: "ë¹„ë°€, ìˆ¨ê²¨ì§„ ë™ê¸°, ì§ê° ë¬´ì‹œ"},
            {name: "THE EMPRESS (ì—¬í™©ì œ)", meaning: "í’ìš”ì™€ ëª¨ì„±ì„ ë‚˜íƒ€ë‚´ëŠ” ì¹´ë“œì…ë‹ˆë‹¤.", upright: "í’ìš”, ëª¨ì„±, ì°½ì¡°ì„±", reversed: "ë¶ˆì„, ì°½ì¡°ì„± ë¶€ì¡±, ê³¼ë³´í˜¸"},
            {name: "THE EMPEROR (í™©ì œ)", meaning: "ê¶Œìœ„ì™€ ì•ˆì •ì„ ë‚˜íƒ€ë‚´ëŠ” ì¹´ë“œì…ë‹ˆë‹¤.", upright: "ê¶Œìœ„, êµ¬ì¡°, ì§ˆì„œ", reversed: "ë…ì¬, ê¶Œìœ„ì£¼ì˜, ê²½ì§ì„±"},
            {name: "THE HIEROPHANT (êµí™©)", meaning: "ì „í†µê³¼ êµìœ¡ì„ ë‚˜íƒ€ë‚´ëŠ” ì¹´ë“œì…ë‹ˆë‹¤.", upright: "ì „í†µ, êµìœ¡, ì¢…êµ", reversed: "ë°˜í•­, ë¹„ì •í†µì„±, ìƒˆë¡œìš´ ì ‘ê·¼ë²•"},
            {name: "THE LOVERS (ì—°ì¸)", meaning: "ì‚¬ë‘ê³¼ ì„ íƒì„ ë‚˜íƒ€ë‚´ëŠ” ì¹´ë“œì…ë‹ˆë‹¤.", upright: "ì‚¬ë‘, ê´€ê³„, ì„ íƒ", reversed: "ë¶ˆê· í˜•, ê°ˆë“±, ì˜ëª»ëœ ì„ íƒ"},
            {name: "THE CHARIOT (ì „ì°¨)", meaning: "ìŠ¹ë¦¬ì™€ ì˜ì§€ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ì¹´ë“œì…ë‹ˆë‹¤.", upright: "ìŠ¹ë¦¬, ì˜ì§€ë ¥, ìì œë ¥", reversed: "í†µì œë ¥ ìƒì‹¤, ë°©í–¥ì„± ë¶€ì¡±"},
            {name: "STRENGTH (í˜)", meaning: "ë‚´ì  í˜ê³¼ ìš©ê¸°ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ì¹´ë“œì…ë‹ˆë‹¤.", upright: "ë‚´ì  í˜, ìš©ê¸°, ì¸ë‚´", reversed: "ì•½í•¨, ìê¸° ì˜ì‹¬, ì—ë„ˆì§€ ë¶€ì¡±"},
            {name: "THE HERMIT (ì€ë‘”ì)", meaning: "ë‚´ì  íƒêµ¬ì™€ ì§€í˜œë¥¼ ë‚˜íƒ€ë‚´ëŠ” ì¹´ë“œì…ë‹ˆë‹¤.", upright: "ë‚´ì  íƒêµ¬, ì§€í˜œ, ì„±ì°°", reversed: "ê³ ë¦½, ì™¸ë¡œì›€, ì˜ëª»ëœ ì¡°ì–¸"},
            {name: "WHEEL OF FORTUNE (ìš´ëª…ì˜ ë°”í€´)", meaning: "ë³€í™”ì™€ ìš´ëª…ì„ ë‚˜íƒ€ë‚´ëŠ” ì¹´ë“œì…ë‹ˆë‹¤.", upright: "ë³€í™”, ìš´ëª…, ê¸°íšŒ", reversed: "ë¶ˆìš´, í†µì œë ¥ ìƒì‹¤, ì™¸ë¶€ ì˜í–¥"},
            {name: "JUSTICE (ì •ì˜)", meaning: "ê³µì •ê³¼ ê· í˜•ì„ ë‚˜íƒ€ë‚´ëŠ” ì¹´ë“œì…ë‹ˆë‹¤.", upright: "ì •ì˜, ê³µì •ì„±, ì§„ì‹¤", reversed: "ë¶ˆê³µì •, í¸ê²¬, ì±…ì„ íšŒí”¼"},
            {name: "THE HANGED MAN (ë§¤ë‹¬ë¦° ë‚¨ì)", meaning: "í¬ìƒê³¼ ê´€ì ì˜ ì „í™˜ì„ ë‚˜íƒ€ë‚´ëŠ” ì¹´ë“œì…ë‹ˆë‹¤.", upright: "í¬ìƒ, ê´€ì  ì „í™˜, ê¸°ë‹¤ë¦¼", reversed: "ë¶ˆí•„ìš”í•œ í¬ìƒ, ì§€ì—°, ì €í•­"},
            {name: "DEATH (ì£½ìŒ)", meaning: "ë³€í™”ì™€ ì¬ìƒì„ ë‚˜íƒ€ë‚´ëŠ” ì¹´ë“œì…ë‹ˆë‹¤.", upright: "ë³€í™”, ëê³¼ ì‹œì‘, ì¬ìƒ", reversed: "ë³€í™”ì— ëŒ€í•œ ì €í•­, ì •ì²´"},
            {name: "TEMPERANCE (ì ˆì œ)", meaning: "ê· í˜•ê³¼ ì¡°í™”ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ì¹´ë“œì…ë‹ˆë‹¤.", upright: "ê· í˜•, ì ˆì œ, ì¡°í™”", reversed: "ë¶ˆê· í˜•, ê³¼ë„í•¨, ì¡°ê¸‰í•¨"},
            {name: "THE DEVIL (ì•…ë§ˆ)", meaning: "ìœ í˜¹ê³¼ ì†ë°•ì„ ë‚˜íƒ€ë‚´ëŠ” ì¹´ë“œì…ë‹ˆë‹¤.", upright: "ìœ í˜¹, ì†ë°•, ì¤‘ë…", reversed: "í•´ë°©, ììœ , ì†ë°•ì—ì„œ ë²—ì–´ë‚¨"},
            {name: "THE TOWER (íƒ‘)", meaning: "íŒŒê´´ì™€ ê¸‰ë³€ì„ ë‚˜íƒ€ë‚´ëŠ” ì¹´ë“œì…ë‹ˆë‹¤.", upright: "íŒŒê´´, ê¸‰ë³€, ê³„ì‹œ", reversed: "ë‚´ì  ë³€í™”, ê°œì¸ì  ë³€í™”"},
            {name: "THE STAR (ë³„)", meaning: "í¬ë§ê³¼ ì˜ê°ì„ ë‚˜íƒ€ë‚´ëŠ” ì¹´ë“œì…ë‹ˆë‹¤.", upright: "í¬ë§, ì˜ê°, ì¹˜ìœ ", reversed: "ì ˆë§, í¬ë§ ìƒì‹¤, ë°©í–¥ì„± ë¶€ì¡±"},
            {name: "THE MOON (ë‹¬)", meaning: "í™˜ìƒê³¼ ë¶ˆì•ˆì„ ë‚˜íƒ€ë‚´ëŠ” ì¹´ë“œì…ë‹ˆë‹¤.", upright: "í™˜ìƒ, ë¶ˆì•ˆ, í˜¼ë€", reversed: "ì§„ì‹¤ ë“œëŸ¬ë‚¨, ëª…í™•ì„±"},
            {name: "THE SUN (íƒœì–‘)", meaning: "ê¸°ì¨ê³¼ ì„±ê³µì„ ë‚˜íƒ€ë‚´ëŠ” ì¹´ë“œì…ë‹ˆë‹¤.", upright: "ê¸°ì¨, ì„±ê³µ, í™œë ¥", reversed: "ì¼ì‹œì  ê¸°ì¨, ì—ë„ˆì§€ ë¶€ì¡±"},
            {name: "JUDGEMENT (ì‹¬íŒ)", meaning: "ë¶€í™œê³¼ ê°ì„±ì„ ë‚˜íƒ€ë‚´ëŠ” ì¹´ë“œì…ë‹ˆë‹¤.", upright: "ë¶€í™œ, ê°ì„±, ìƒˆë¡œìš´ ì‹œì‘", reversed: "ìê¸° ì˜ì‹¬, ê³¼ê±°ì— ì–½ë§¤ì„"},
            {name: "THE WORLD (ì„¸ê³„)", meaning: "ì™„ì„±ê³¼ ì„±ì·¨ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ì¹´ë“œì…ë‹ˆë‹¤.", upright: "ì™„ì„±, ì„±ì·¨, í†µí•©", reversed: "ë¯¸ì™„ì„±, ëª©í‘œ ë¶€ì¡±, ì§€ì—°"}
        ];

        const CARD_ICONS = ["ğŸƒ", "ğŸ©", "ğŸ”®", "ğŸ‘‘", "âš¡", "â›ª", "ğŸ’•", "ğŸ†", "ğŸ’ª", "ğŸ•¯ï¸", "ğŸ°", "âš–ï¸", "ğŸ™ƒ", "ğŸ’€", "âš–ï¸", "ğŸ˜ˆ", "ğŸ—¼", "â­", "ğŸŒ™", "â˜€ï¸", "ğŸ“¯", "ğŸŒ"];

        function initializeTarot() {
            const tarotCards = $$('.tarot-card-back');
            
            tarotCards.forEach(card => {
                if (card.__bound) return;
                card.addEventListener('click', () => selectTarotCard(card));
                card.__bound = true;
            });

            const randomBtn = $('#btnRandomTarot');
            if (randomBtn && !randomBtn.__bound) {
                randomBtn.addEventListener('click', drawRandomTarotCard);
                randomBtn.__bound = true;
            }

            const resetBtn = $('#btnResetTarot');
            if (resetBtn && !resetBtn.__bound) {
                resetBtn.addEventListener('click', resetTarotCards);
                resetBtn.__bound = true;
            }

            resetTarotCards();
        }

        function selectTarotCard(cardElement) {
            if (cardElement.classList.contains('revealed')) return;

            const randomTarotIndex = Math.floor(Math.random() * TAROT_DETAILS.length);
            const isUpright = Math.random() < 0.7;
            const selectedCard = TAROT_DETAILS[randomTarotIndex];

            if (!selectedCard) return;

            cardElement.classList.add('flipped');
            
            setTimeout(() => {
                const frontElement = document.createElement('div');
                frontElement.className = 'tarot-card-front';
                frontElement.innerHTML = `
                <div class="card-number">${randomTarotIndex}</div>
                <div class="card-icon">${CARD_ICONS[randomTarotIndex]}</div>
                <div class="card-name">${selectedCard.name.split('(')[0].trim()}</div>
                <div class="card-direction">${isUpright ? 'ì •ìœ„' : 'ì—­ìœ„'}</div>
                `;
                cardElement.appendChild(frontElement);
                cardElement.classList.add('revealed');
                setTimeout(() => frontElement.style.opacity = '1', 100);
            }, 300);

            setTimeout(() => showTarotModal(randomTarotIndex, isUpright), 800);
            
            pushRecent({
                type: 'tarot',
                card: selectedCard.name,
                upright: isUpright,
                meaning: isUpright ? selectedCard.upright : selectedCard.reversed
            });
            
            reactCrystal(`${selectedCard.name.split('(')[0].trim()}ì„ ë½‘ì•˜ìŠµë‹ˆë‹¤! âœ¨`);
        }

        function showTarotModal(cardIndex, isUpright) {
            const modal = $('#tarotModalOverlay');
            const content = $('#tarotModalContent');
            if (!modal || !content) return;

            const card = TAROT_DETAILS[cardIndex];
            if (!card) return;

            content.innerHTML = `
            <h2>${card.name}</h2>
            <p style="color:#6B7280; margin-bottom:20px; line-height:1.6; font-style:italic;">${card.meaning}</p>
            <div class="meaning-section upright"><h3>â¬†ï¸ ì •ë°©í–¥ ì˜ë¯¸</h3><p>${card.upright}</p></div>
            <br>
            <div class="meaning-section reversed"><h3>â¬‡ï¸ ì—­ë°©í–¥ ì˜ë¯¸</h3><p>${card.reversed}</p></div>
            <div style="margin-top:25px; padding:15px; background:rgba(255,215,0,0.1); border-radius:10px; border-left:4px solid #ffd700;">
                <h3 style="color:#ffd700; margin-bottom:10px;">${isUpright ? 'â¬†ï¸ í˜„ì¬ ë½‘íŒ ë°©í–¥: ì •ë°©í–¥' : 'â¬‡ï¸ í˜„ì¬ ë½‘íŒ ë°©í–¥: ì—­ë°©í–¥'}</h3>
                <p style="color:#333; line-height:1.5;">${isUpright ? card.upright : card.reversed}</p>
            </div>
            `;
            
            modal.style.display = 'flex';
            requestAnimationFrame(() => modal.classList.add('show'));
        }

        function closeTarotModal() {
            const modal = $('#tarotModalOverlay');
            if (!modal) return;
            modal.classList.remove('show');
            modal.style.display = 'none';
        }

        function resetTarotCards() {
            $$('.tarot-card-back').forEach(card => {
                card.classList.remove('flipped', 'revealed');
                card.style.transform = '';
                card.querySelector('.tarot-card-front')?.remove();
            });
            closeTarotModal();
            reactCrystal('ìƒˆë¡œìš´ ì¹´ë“œë“¤ì´ ì¤€ë¹„ë˜ì—ˆìŠµë‹ˆë‹¤ âœ¨');
        }

        function drawRandomTarotCard() {
            const available = $$('.tarot-card-back:not(.revealed)');
            if (!available.length) {
                reactCrystal('ëª¨ë“  ì¹´ë“œë¥¼ ì´ë¯¸ ë½‘ì•˜ìŠµë‹ˆë‹¤! ğŸ”„');
                return;
            }
            const el = available[Math.floor(Math.random() * available.length)];
            setTimeout(() => selectTarotCard(el), 300);
        }

        // ===========================================
        // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
        // ===========================================
        function bindEventListeners() {
            console.log('ğŸ”— ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë°”ì¸ë”© ì‹œì‘...');

            // ì˜¤ëŠ˜ì˜ ìš´ì„¸ ë²„íŠ¼
            $('#btnToday')?.addEventListener('click', () => {
                const birthRaw = $('#today-birth')?.value || '';
                const name = $('#today-name')?.value?.trim() || '';

                try {
                    if (!birthRaw.trim()) {
                        alert('ìƒë…„ì›”ì¼ì„ ì…ë ¥í•˜ì„¸ìš”.');
                        return;
                    }

                    const fortuneData = calcEnhancedDailyFortune(birthRaw);
                    const htmlResult = renderEnhancedDailyFortune(fortuneData, name);

                    openSheet('ì˜¤ëŠ˜ì˜ ìš´ì„¸', htmlResult, {
                        type: 'enhanced-today',
                        birth_input: birthRaw,
                        name: name,
                        data: fortuneData
                    });

                    reactCrystal('ì˜¤ëŠ˜ì˜ ìƒì„¸ ìš´ì„¸ë¥¼ ë¶ˆëŸ¬ì™”ìŠµë‹ˆë‹¤! âœ¨');
                } catch (e) {
                    console.error(e);
                    alert(e.message || 'ì…ë ¥ ê°’ì„ í™•ì¸í•´ ì£¼ì„¸ìš”.');
                }
            });

            // ë¡œë˜ ë²ˆí˜¸ ë²„íŠ¼
            $('#btnLotto')?.addEventListener('click', () => {
                const birth = $('#lotto-birth')?.value?.trim() || '';
                try {
                    const result = generateLottoNumbers(birth);
                    const html = renderLottoResult(result);
                    
                    openSheet('ğŸ± í–‰ìš´ì˜ ë¡œë˜ë²ˆí˜¸', html, {
                        type: 'lotto',
                        birth,
                        result
                    });
                    
                    reactCrystal('ì´ë²ˆ ì£¼ í–‰ìš´ë²ˆí˜¸ë¥¼ ë½‘ì•˜ì–´ìš”! âœ¨');
                } catch (e) {
                    console.error(e);
                    alert('í–‰ìš´ë²ˆí˜¸ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
                }
            });

            // ì‹œíŠ¸ ë‹«ê¸° ë²„íŠ¼
            $('#btnClose')?.addEventListener('click', closeSheet);
            
            // ì‹œíŠ¸ ë°°ê²½ í´ë¦­ì‹œ ë‹«ê¸°
            sheet?.addEventListener('click', e => {
                if (e.target === sheet) closeSheet();
            });

            // ê²°ê³¼ ì €ì¥ ë²„íŠ¼
            $('#btnSave')?.addEventListener('click', () => {
                if (!lastResult) {
                    closeSheet();
                    return;
                }
                pushRecent(lastResult);
                
                const notice = document.createElement('div');
                notice.textContent = 'ğŸ“ ìµœê·¼ ê²°ê³¼ì— ì €ì¥ëìŠµë‹ˆë‹¤.';
                notice.style.cssText = 'margin-top:16px;padding:12px;background:rgba(102,126,234,0.1);border-radius:8px;text-align:center;color:#667eea;font-weight:bold;';
                sheetContent?.appendChild(notice);
                setTimeout(() => notice.remove(), 3000);
            });

            // ë„¤ë¹„ê²Œì´ì…˜ í´ë¦­
            $$('.nav-item[data-tab]').forEach(item => {
                item.addEventListener('click', () => {
                    const tab = item.dataset.tab || 'home';
                    location.hash = '#/' + tab;
                    reactCrystal(`${tab} í˜ì´ì§€ë¡œ ì´ë™í•©ë‹ˆë‹¤! âœ¨`);
                });
            });

            // ì„œë¹„ìŠ¤ ì¹´ë“œ í´ë¦­
            $$('.service-item, .special-item').forEach(card => {
                card.addEventListener('click', () => {
                    const route = card.dataset.route || 'fortune-today';
                    if (route.startsWith('fortune-')) {
                        location.hash = '#/fortune/' + route.replace('fortune-', '');
                    }
                });
            });

            // í¬ë¦¬ìŠ¤íƒˆ í´ë¦­
            $('#mainCrystal')?.addEventListener('click', () => {
                reactCrystal('ğŸ”® ì‹ ë¹„ë¡œìš´ í˜ì„ ëŠê»´ë³´ì„¸ìš”');
            });

            // íƒ€ë¡œ ëª¨ë‹¬ ë‹«ê¸°
            $('#tarotCloseBtn')?.addEventListener('click', closeTarotModal);
            
            // íƒ€ë¡œ ëª¨ë‹¬ ë°°ê²½ í´ë¦­
            $('#tarotModalOverlay')?.addEventListener('click', e => {
                if (e.target === $('#tarotModalOverlay')) closeTarotModal();
            });

            console.log('âœ… ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë°”ì¸ë”© ì™„ë£Œ');
        }

        // ===========================================
        // ì´ˆê¸°í™”
        // ===========================================
        function initMysticTell() {
            console.log('ğŸš€ MysticTell ì´ˆê¸°í™” ì‹œì‘...');

            // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë°”ì¸ë”©
            bindEventListeners();

            // ìŠ¤í”Œë˜ì‹œ ìˆ¨ê¸°ê¸°
            hideSplash();

            // ì´ˆê¸° ë¼ìš°íŒ…
            if (!location.hash) {
                location.hash = '#/home';
            }
            routeFromHash();

            console.log('âœ… MysticTell ì´ˆê¸°í™” ì™„ë£Œ');
        }

        // ===========================================
        // ì „ì—­ ì´ë²¤íŠ¸
        // ===========================================

        // í•´ì‹œ ë³€ê²½ ì‹œ ë¼ìš°íŒ…
        window.addEventListener('hashchange', routeFromHash);

        // í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ ì‹œ ì´ˆê¸°í™”
        window.addEventListener('load', initMysticTell);

        // DOM ì¤€ë¹„ ì‹œ ìŠ¤í”Œë˜ì‹œ ì²˜ë¦¬
        document.addEventListener('DOMContentLoaded', () => {
            const startBtn = $('#startBtn');
            startBtn?.addEventListener('click', (e) => {
                e.preventDefault();
                hideSplash();
            });

            // ìë™ ìŠ¤í”Œë˜ì‹œ ìˆ¨ê¹€ (3ì´ˆ í›„)
            setTimeout(hideSplash, 3000);
        });

        // ESC í‚¤ë¡œ ëª¨ë‹¬ ë‹«ê¸°
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                closeAllOverlays();
            }
        });

        // ì—ëŸ¬ ì²˜ë¦¬
        window.addEventListener('error', (e) => {
            console.error('Global error:', e);
            closeSheet();
        });

        console.log('ğŸ“± MysticTell JavaScript ë¡œë“œ ì™„ë£Œ');
    </script>
</body>
</html>
